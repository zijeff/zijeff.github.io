

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="zijeff">
  <meta name="keywords" content="">
  
    <meta name="description" content="Warm Up æˆ‘ä»¬æ¥é€è¡Œåˆ†æé¢˜ç›®ï¼š   å¯†é’¥æ˜¯å›ºå®šçš„ï¼š 1key &#x3D; Random(2025).randbytes(16) è¿™é‡Œä½¿ç”¨äº† random åº“ï¼ˆæ¢…æ£®æ—‹è½¬ç®—æ³•ï¼‰ï¼Œå¹¶ä¸”æŒ‡å®šäº†ç§å­ 2025ã€‚è¿™æ„å‘³ç€æ— è®ºä½•æ—¶è¿è¡Œè¿™æ®µä»£ç ï¼Œç”Ÿæˆçš„ key éƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è§£å¯†è„šæœ¬ä¸­ç”ŸæˆåŒæ ·çš„ Keyã€‚   CBCæ¨¡å¼çš„IVä¾èµ–äºæ˜æ–‡ï¼š 1AES.new(key, AES.MODE_CBC, iv">
<meta property="og:type" content="article">
<meta property="og:title" content="LilCTF2025wp">
<meta property="og:url" content="https://zijeff.github.io/2026/03/01/LilCTF2025wp/index.html">
<meta property="og:site_name" content="æå¤©ä¸€çº¿äº‘">
<meta property="og:description" content="Warm Up æˆ‘ä»¬æ¥é€è¡Œåˆ†æé¢˜ç›®ï¼š   å¯†é’¥æ˜¯å›ºå®šçš„ï¼š 1key &#x3D; Random(2025).randbytes(16) è¿™é‡Œä½¿ç”¨äº† random åº“ï¼ˆæ¢…æ£®æ—‹è½¬ç®—æ³•ï¼‰ï¼Œå¹¶ä¸”æŒ‡å®šäº†ç§å­ 2025ã€‚è¿™æ„å‘³ç€æ— è®ºä½•æ—¶è¿è¡Œè¿™æ®µä»£ç ï¼Œç”Ÿæˆçš„ key éƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è§£å¯†è„šæœ¬ä¸­ç”ŸæˆåŒæ ·çš„ Keyã€‚   CBCæ¨¡å¼çš„IVä¾èµ–äºæ˜æ–‡ï¼š 1AES.new(key, AES.MODE_CBC, iv">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://zijeff.github.io/2026/03/01/LilCTF2025wp/1.png">
<meta property="og:image" content="https://zijeff.github.io/2026/03/01/LilCTF2025wp/2.png">
<meta property="og:image" content="https://zijeff.github.io/2026/03/01/LilCTF2025wp/3.png">
<meta property="og:image" content="https://zijeff.github.io/2026/03/01/LilCTF2025wp/4.png">
<meta property="og:image" content="https://zijeff.github.io/2026/03/01/LilCTF2025wp/5.png">
<meta property="og:image" content="https://zijeff.github.io/2026/03/01/LilCTF2025wp/6.png">
<meta property="article:published_time" content="2026-03-01T07:15:07.000Z">
<meta property="article:modified_time" content="2026-03-01T07:27:36.068Z">
<meta property="article:author" content="zijeff">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://zijeff.github.io/2026/03/01/LilCTF2025wp/1.png">
  
  
  
  <title>LilCTF2025wp - æå¤©ä¸€çº¿äº‘</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"zijeff.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.1.1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>æå¤©ä¸€çº¿äº‘</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="LilCTF2025wp"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2026-03-01 15:15" pubdate>
          2026å¹´3æœˆ1æ—¥ ä¸‹åˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3.6k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          31 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">LilCTF2025wp</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="Warm-Up">Warm Up</h2>
<p>æˆ‘ä»¬æ¥é€è¡Œåˆ†æé¢˜ç›®ï¼š</p>
<ol>
<li>
<p><strong>å¯†é’¥æ˜¯å›ºå®šçš„</strong>ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">key = Random(<span class="hljs-number">2025</span>).randbytes(<span class="hljs-number">16</span>)<br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œä½¿ç”¨äº† random åº“ï¼ˆæ¢…æ£®æ—‹è½¬ç®—æ³•ï¼‰ï¼Œå¹¶ä¸”æŒ‡å®šäº†ç§å­ 2025ã€‚è¿™æ„å‘³ç€æ— è®ºä½•æ—¶è¿è¡Œè¿™æ®µä»£ç ï¼Œç”Ÿæˆçš„ key éƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è§£å¯†è„šæœ¬ä¸­ç”ŸæˆåŒæ ·çš„ Keyã€‚</p>
</li>
<li>
<p><strong>CBCæ¨¡å¼çš„IVä¾èµ–äºæ˜æ–‡</strong>ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">AES.new(key, AES.MODE_CBC, iv=FLAG[<span class="hljs-number">9</span>:<span class="hljs-number">25</span>])<br></code></pre></td></tr></table></figure>
<p>ä½¿ç”¨äº† AES çš„ CBC æ¨¡å¼ã€‚</p>
<ul>
<li><strong>Key</strong>: å·²çŸ¥ã€‚</li>
<li><strong>IV (åˆå§‹åŒ–å‘é‡)</strong>: å–è‡ª FLAG çš„ç¬¬ 9 åˆ° 25 ä¸ªå­—èŠ‚ (FLAG[9:25])ã€‚</li>
<li><strong>Plaintext</strong>: å¡«å……åçš„ FLAGã€‚</li>
</ul>
</li>
</ol>
<p>è€Œ <strong>AES-CBC</strong> æ¨¡å¼çš„è§£å¯†è¿‡ç¨‹å¦‚ä¸‹ï¼š<br>
$$<br>
P_i = D_k(C_i)\oplus C_{i-1}<br>
$$<br>
å…¶ä¸­ï¼Œ$C_i$ æ˜¯å¯†æ–‡å—ï¼Œ$P_i$ æ˜¯æ˜æ–‡å—ï¼Œ$D_k$ æ˜¯è§£å¯†å‡½æ•°ã€‚ç‰¹æ®Šåœ°ï¼Œ$C_{-1}$ å°±æ˜¯åˆå§‹åŒ–å‘é‡ã€‚</p>
<p>å‡è®¾ Flag é•¿åº¦ç»è¿‡å¡«å……åè¢«åˆ†ä¸º $P_0, P_1, P_2â€¦$ å‡ ä¸ªå—ï¼ˆæ¯å—16å­—èŠ‚ï¼‰ï¼Œå¯†æ–‡åˆ†ä¸º $C_0, C_1, C_2â€¦$ã€‚</p>
<p><strong>å¯¹äºé™¤äº†ç¬¬ä¸€å—ä»¥å¤–çš„æ‰€æœ‰å— ($i &gt; 0$)ï¼š</strong><br>
$$<br>
P_i = Dec_{key}(C_i) \oplus C_{i-1}<br>
$$<br>
å› ä¸º Key æ˜¯å·²çŸ¥çš„ï¼Œä¸”å¯†æ–‡ $C$â€‹ æ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥<strong>ç›´æ¥è§£å¯†å‡ºé™¤äº†ç¬¬ä¸€å—ä»¥å¤–çš„æ‰€æœ‰æ˜æ–‡</strong>ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çŸ¥é“äº† <strong>FLAG[16:]</strong> çš„æ‰€æœ‰å†…å®¹ã€‚</p>
<p><strong>å¯¹äºç¬¬ä¸€å— ($P_0$)ï¼š</strong><br>
$$<br>
P_0 = Dec_{key}(C_0) \oplus IV<br>
$$<br>
è¿™é‡Œ $P_0$ æ˜¯ <strong>FLAG[0:16]</strong>ï¼Œ$IV$ æ˜¯ <strong>FLAG[9:25]</strong>ã€‚ä»¤ä¸­é—´çŠ¶æ€ $X_0 = Dec_{key}(C_0)$ï¼ˆè¿™æ˜¯æˆ‘ä»¬èƒ½ç®—å‡ºæ¥çš„ï¼‰ï¼Œé‚£ä¹ˆåˆ™æœ‰ï¼š<br>
$$<br>
FLAG[0:16] = X_0 \oplus FLAG[9:25]<br>
$$<br>
å¦‚æœæˆ‘ä»¬æŒ‰å­—èŠ‚æ¥çœ‹è¿™ä¸ªå¼‚æˆ–å…³ç³»ï¼ˆè®¾ $f_i$ ä¸º Flag çš„ç¬¬ $i$ ä¸ªå­—èŠ‚ï¼‰ï¼š<br>
$$<br>
f_i = X_0[i] \oplus f_{i+9} \quad (\text{å¯¹äº } 0 \le i \le 15)<br>
$$<br>
è¿™å°±æ˜¯è§£é¢˜çš„å…³é”®ï¼š</p>
<ol>
<li>æˆ‘ä»¬é€šè¿‡è§£å¯† $C_1, C_2â€¦$ å·²ç»çŸ¥é“äº† $f_{16}$ åŠå…¶ä¹‹åçš„æ‰€æœ‰å­—èŠ‚ã€‚</li>
<li>åˆ©ç”¨å…¬å¼ $f_i = X_0[i] \oplus f_{i+9}$ï¼š
<ul>
<li>å½“ $i=7$ æ—¶ï¼š$f_7 = X_0[7] \oplus f_{16}$ã€‚å› ä¸º $f_{16}$ å·²çŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç®—å‡º $f_7$ã€‚</li>
<li>ä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç®—å‡º $f_7$ åˆ° $f_{15}$ï¼ˆåˆ©ç”¨å·²çŸ¥çš„ $f_{16}$ åˆ° $f_{24}$ï¼‰ã€‚</li>
</ul>
</li>
<li>ä¸€æ—¦æˆ‘ä»¬çŸ¥é“äº† $f_9$ åˆ° $f_{15}$ï¼Œæˆ‘ä»¬å†æ¬¡åˆ©ç”¨å…¬å¼ï¼š
<ul>
<li>å½“ $i=0$ æ—¶ï¼š$f_0 = X_0[0] \oplus f_9$ã€‚å› ä¸º $f_9$ åˆšæ‰ç®—å‡ºæ¥äº†ï¼Œæ‰€ä»¥ $f_0$ å¯æ±‚ã€‚</li>
<li>ä»¥æ­¤ç±»æ¨ï¼Œç®—å‡º $f_0$ åˆ° $f_6$ã€‚</li>
</ul>
</li>
</ol>
<p>æ‰€ä»¥ï¼Œè§£é¢˜ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    ciphertext_hex = <span class="hljs-string">&quot;ae39cfab1ba8d38fc3761216c393caf16e3c3f13fe57e2dedd52f1b13072fa93df405c7e731a193cabe5fd88ee3241f79aded62d139faba8c767a3b8efc5a855&quot;</span> <br>    <br>    ct = <span class="hljs-built_in">bytes</span>.fromhex(ciphertext_hex)<br><br>    key = Random(<span class="hljs-number">2025</span>).randbytes(<span class="hljs-number">16</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Recovered Key: <span class="hljs-subst">&#123;key.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># æˆ‘ä»¬ä½¿ç”¨ ECB æ¨¡å¼æ¥æ‰‹åŠ¨å¤„ç†æ¯ä¸ªå—çš„è§£å¯†å’Œå¼‚æˆ–æ“ä½œ</span><br>    aes_ecb = AES.new(key, AES.MODE_ECB)<br><br>    plaintext_suffix = <span class="hljs-string">b&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>, <span class="hljs-built_in">len</span>(ct), <span class="hljs-number">16</span>):<br>        curr_blk = ct[i:i+<span class="hljs-number">16</span>]<br>        prev_blk = ct[i-<span class="hljs-number">16</span>:i]<br>        <br>        dec_out = aes_ecb.decrypt(curr_blk)<br>        pt_blk = <span class="hljs-built_in">bytes</span>(a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(dec_out, prev_blk))<br>        plaintext_suffix += pt_blk<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Recovered suffix (block 1+): <span class="hljs-subst">&#123;plaintext_suffix&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># æˆ‘ä»¬æ„å»ºä¸€ä¸ªåˆ—è¡¨æ¥å­˜æ”¾ flagï¼Œç›®å‰å·²çŸ¥çš„æ˜¯ suffix éƒ¨åˆ†</span><br>    <span class="hljs-comment"># å‰16ä¸ªå­—èŠ‚åˆå§‹åŒ–ä¸º0</span><br>    flag_bytes = <span class="hljs-built_in">list</span>(<span class="hljs-string">b&#x27;\x00&#x27;</span> * <span class="hljs-number">16</span>) + <span class="hljs-built_in">list</span>(plaintext_suffix)<br>    <br>    <span class="hljs-comment"># è®¡ç®—ç¬¬ä¸€å—å¯†æ–‡ç»è¿‡ AES è§£å¯†åçš„ä¸­é—´çŠ¶æ€ X0</span><br>    <span class="hljs-comment"># P0 = X0 ^ IV  =&gt;  flag[0:16] = X0 ^ flag[9:25]</span><br>    x0 = aes_ecb.decrypt(ct[<span class="hljs-number">0</span>:<span class="hljs-number">16</span>])<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>, <span class="hljs-number">16</span>):<br>        flag_bytes[i] = x0[i] ^ flag_bytes[i+<span class="hljs-number">9</span>]<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>):<br>        flag_bytes[i] = x0[i] ^ flag_bytes[i+<span class="hljs-number">9</span>]<br><br>    full_flag_padded = <span class="hljs-built_in">bytes</span>(flag_bytes)<br>    <span class="hljs-keyword">try</span>:<br>        flag = unpad(full_flag_padded, <span class="hljs-number">16</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[SUCCESS] FLAG: <span class="hljs-subst">&#123;flag.decode()&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] Padding error or logic error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Raw recovered bytes: <span class="hljs-subst">&#123;full_flag_padded&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    solve()<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p>
<img src="/2026/03/01/LilCTF2025wp/1.png" srcset="/img/loading.gif" lazyload class="">
<h2 id="ez-math">ez_math</h2>
<h1>æˆ‘ä»¬å·²çŸ¥ A å‘é‡ï¼Œä¸ºäº†åç»­æ–¹ä¾¿è¿ç®—ï¼Œæˆ‘ä»¬å†™æˆåˆ—å‘é‡çš„å½¢å¼ï¼š<br>
$$<br>
A =<br>
\begin{bmatrix}<br>
v_1 \newline<br>
v_2<br>
\end{bmatrix}<br>
$$<br>
æˆ‘ä»¬æ ¹æ® B çš„ç”Ÿæˆæ–¹å¼ï¼Œå¯ä»¥å°†å…¶è¿›è¡Œåˆ†è§£æˆä¸¤ä¸ªçŸ©é˜µç›¸ä¹˜çš„å½¢å¼ï¼š<br>
$$<br>
B =<br>
\begin{bmatrix}<br>
v_1\lambda_1 \newline<br>
v_2\lambda_2<br>
\end{bmatrix}</h1>
<h1>\begin{bmatrix}<br>
\lambda_1 &amp; 0 \newline<br>
0 &amp; \lambda_2<br>
\end{bmatrix}<br>
\begin{bmatrix}<br>
v_1 \newline<br>
v_2<br>
\end{bmatrix}</h1>
<p>\begin{bmatrix}<br>
\lambda_1 &amp; 0 \newline<br>
0 &amp; \lambda_2<br>
\end{bmatrix}<br>
A<br>
$$<br>
ç„¶åå†è§‚å¯Ÿç”Ÿæˆçš„ Cï¼Œå¯ä»¥å‘ç°è²Œä¼¼æ‰¾åˆ°äº†æ€è·¯ï¼š<br>
$$<br>
C = A^{-1}B=A^{-1}<br>
\begin{bmatrix}<br>
\lambda_1 &amp; 0 \newline<br>
0 &amp; \lambda_2<br>
\end{bmatrix}<br>
A<br>
$$<br>
æˆ‘ä»¬è®¾<br>
$$<br>
D=<br>
\begin{bmatrix}<br>
\lambda_1 &amp; 0 \newline<br>
0 &amp; \lambda_2<br>
\end{bmatrix}<br>
$$<br>
ä¸Šè¿°çš„åˆ†æè¯´æ˜ï¼ŒC å’Œ D çŸ©é˜µç›¸ä¼¼ï¼Œç”±ç›¸ä¼¼çŸ©é˜µçš„ç‰¹æ€§å¯çŸ¥å…¶ç‰¹å¾å€¼ä¸€æ ·ã€‚é‚£ä¹ˆç›´æ¥æ±‚ C çš„ç‰¹å¾å€¼å³å¯ï¼Œå†è½¬æ¢ä¸º ASCII å­—ç¬¦ä¾¿èƒ½è·å–åˆ° flagã€‚</p>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">9620154777088870694266521670168986508003314866222315790126552504304846236696183733266828489404860276326158191906907396234236947215466295418632056113826161</span><br>C = matrix(GF(p), [[<span class="hljs-number">7062910478232783138765983170626687981202937184255408287607971780139482616525215270216675887321965798418829038273232695370210503086491228434856538620699645</span>,<span class="hljs-number">7096268905956462643320137667780334763649635657732499491108171622164208662688609295607684620630301031789132814209784948222802930089030287484015336757787801</span>],<br>                  [<span class="hljs-number">7341430053606172329602911405905754386729224669425325419124733847060694853483825396200841609125574923525535532184467150746385826443392039086079562905059808</span>,<span class="hljs-number">2557244298856087555500538499542298526800377681966907502518580724165363620170968463050152602083665991230143669519866828587671059318627542153367879596260872</span>]])<br>[lambda1, lambda2] = C.eigenvalues()<br><span class="hljs-built_in">print</span>(lambda1, lambda2) <br><span class="hljs-built_in">print</span>(<span class="hljs-string">b&#x27;LILCTF&#123;&#x27;</span>+long_to_bytes(<span class="hljs-built_in">int</span>(lambda1)) + long_to_bytes(<span class="hljs-built_in">int</span>(lambda2))+<span class="hljs-string">b&#x27;&#125;&#x27;</span>)<br><br></code></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p>
<img src="/2026/03/01/LilCTF2025wp/2.png" srcset="/img/loading.gif" lazyload class="">
<h2 id="mid-math">mid_math</h2>
<p>æœ¬é¢˜å’Œä¸Šè¾¹é¢˜ç›®è¿˜æ˜¯æ¯”è¾ƒç›¸ä¼¼çš„ï¼Œåªæ˜¯å¤šäº†ä¸€æ­¥æ±‚è§£ç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚<br>
æ ¹æ®åˆ†æï¼Œå¯ä»¥å‘ç°çŸ©é˜µ C ç›¸ä¼¼äºä¸€ä¸ªå¯¹è§’çŸ©é˜µï¼š<br>
$$<br>
\begin{bmatrix}<br>
a &amp; 0 &amp; 0 &amp; 0 &amp; 0 \newline<br>
0 &amp; b &amp; 0 &amp; 0 &amp; 0 \newline<br>
0 &amp; 0 &amp; c &amp; 0 &amp; 0 \newline<br>
0 &amp; 0 &amp; 0 &amp; d &amp; 0 \newline<br>
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0<br>
\end{bmatrix}<br>
$$<br>
å…¶ç‰¹å¾å€¼ä¸º $a,b,c,d,0$ é‚£ä¹ˆç”± $D=C^{key}$â€‹ï¼Œåˆ™ D å¯¹åº”çš„ç‰¹å¾å€¼ä¸ºï¼š<br>
$$<br>
a^{key},b^{key},c^{key},d^{key},0\mod p<br>
$$<br>
åœ¨æ±‚å‡ºç‰¹å¾å€¼åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡æ±‚è§£<strong>ç¦»æ•£å¯¹æ•°é—®é¢˜</strong>è·å– keyï¼Œä¹‹åä¾¿å¯ä»¥è·å–flag</p>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad, pad<br><br>p = <span class="hljs-number">14668080038311483271</span><br>C_list = [[<span class="hljs-number">11315841881544731102</span>, <span class="hljs-number">2283439871732792326</span>, <span class="hljs-number">6800685968958241983</span>, <span class="hljs-number">6426158106328779372</span>, <span class="hljs-number">9681186993951502212</span>],<br>          [<span class="hljs-number">4729583429936371197</span>, <span class="hljs-number">9934441408437898498</span>, <span class="hljs-number">12454838789798706101</span>, <span class="hljs-number">1137624354220162514</span>, <span class="hljs-number">8961427323294527914</span>],<br>          [<span class="hljs-number">12212265161975165517</span>, <span class="hljs-number">8264257544674837561</span>, <span class="hljs-number">10531819068765930248</span>, <span class="hljs-number">4088354401871232602</span>, <span class="hljs-number">14653951889442072670</span>],<br>          [<span class="hljs-number">6045978019175462652</span>, <span class="hljs-number">11202714988272207073</span>, <span class="hljs-number">13562937263226951112</span>, <span class="hljs-number">6648446245634067896</span>, <span class="hljs-number">13902820281072641413</span>],<br>          [<span class="hljs-number">1046075193917103481</span>, <span class="hljs-number">3617988773170202613</span>, <span class="hljs-number">3590111338369894405</span>, <span class="hljs-number">2646640112163975771</span>, <span class="hljs-number">5966864698750134707</span>]]<br>D_list = [[<span class="hljs-number">1785348659555163021</span>, <span class="hljs-number">3612773974290420260</span>, <span class="hljs-number">8587341808081935796</span>, <span class="hljs-number">4393730037042586815</span>, <span class="hljs-number">10490463205723658044</span>],<br>          [<span class="hljs-number">10457678631610076741</span>, <span class="hljs-number">1645527195687648140</span>, <span class="hljs-number">13013316081830726847</span>, <span class="hljs-number">12925223531522879912</span>, <span class="hljs-number">5478687620744215372</span>],<br>          [<span class="hljs-number">9878636900393157276</span>, <span class="hljs-number">13274969755872629366</span>, <span class="hljs-number">3231582918568068174</span>, <span class="hljs-number">7045188483430589163</span>, <span class="hljs-number">5126509884591016427</span>],<br>          [<span class="hljs-number">4914941908205759200</span>, <span class="hljs-number">7480989013464904670</span>, <span class="hljs-number">5860406622199128154</span>, <span class="hljs-number">8016615177615097542</span>, <span class="hljs-number">13266674393818320551</span>],<br>          [<span class="hljs-number">3005316032591310201</span>, <span class="hljs-number">6624508725257625760</span>, <span class="hljs-number">7972954954270186094</span>, <span class="hljs-number">5331046349070112118</span>, <span class="hljs-number">6127026494304272395</span>]]<br>msg = <span class="hljs-string">b&quot;\xcc]B:\xe8\xbc\x91\xe2\x93\xaa\x88\x17\xc4\xe5\x97\x87@\x0fd\xb5p\x81\x1e\x98,Z\xe1n`\xaf\xe0%:\xb7\x8aD\x03\xd2Wu5\xcd\xc4#m&#x27;\xa7\xa4\x80\x0b\xf7\xda8\x1b\x82k#\xc1gP\xbd/\xb5j&quot;</span><br><br>Fp = GF(p)<br>C_mat = matrix(Fp, C_list)<br>D_mat = matrix(Fp, D_list)<br><br><span class="hljs-comment">#è®¡ç®— C å’Œ D çš„ç‰¹å¾å€¼</span><br>eval_C = C_mat.eigenvalues()<br>eval_D = D_mat.eigenvalues()<br><br><span class="hljs-comment">#å»æ‰0ç‰¹å¾å€¼</span><br>eval_C_nonzero = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> eval_C <span class="hljs-keyword">if</span> x != <span class="hljs-number">0</span>]<br>eval_D_nonzero = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> eval_D <span class="hljs-keyword">if</span> x != <span class="hljs-number">0</span>]<br><br><span class="hljs-comment">#è¾“å‡ºç‰¹å¾å€¼</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Nonzero eigenvalues of C:&quot;</span>, eval_C_nonzero)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Nonzero eigenvalues of D:&quot;</span>, eval_D_nonzero)<br><br><span class="hljs-comment">#å°è¯•è®¡ç®—ç¦»æ•£å¯¹æ•°ä»¥æ‰¾åˆ°key</span><br>key = <span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> mu <span class="hljs-keyword">in</span> eval_D_nonzero:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment">#å°è¯•è®¡ç®—ç¬¬ä¸€ä¸ªéé›¶ç‰¹å¾å€¼å¯¹åº”çš„kå€¼</span><br>        k = discrete_log(mu, eval_C_nonzero[<span class="hljs-number">0</span>])<br>        <span class="hljs-comment">#æ£€æŸ¥kæ˜¯å¦æ»¡è¶³æ¡ä»¶</span><br>        valid = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">for</span> lam <span class="hljs-keyword">in</span> eval_C_nonzero:<br>            <span class="hljs-keyword">if</span> lam^k <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> eval_D_nonzero:<br>                valid = <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> valid:<br>            key = k<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found key: <span class="hljs-subst">&#123;key&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">continue</span><br><br><span class="hljs-keyword">if</span> key <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;Key not found&quot;</span>)<br><br>key_bytes = pad(long_to_bytes(key), <span class="hljs-number">16</span>)<br>aes = AES.new(key_bytes, AES.MODE_ECB)<br>flag = unpad(aes.decrypt(msg), <span class="hljs-number">64</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag:&quot;</span>, flag)<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p>
<img src="/2026/03/01/LilCTF2025wp/3.png" srcset="/img/loading.gif" lazyload class="">
<h2 id="Space-Travel">Space Travel</h2>
<p>ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†åœ¨äºç”Ÿæˆ <code>key</code> å’Œæ³„éœ²ä¿¡æ¯ï¼ˆGiftï¼‰ï¼š</p>
<ol>
<li>
<p><strong>Key çš„ç”Ÿæˆ</strong>:</p>
<ul>
<li><code>key</code> æ˜¯ç”± 50 ä¸ªæ¥è‡ª <code>vecs</code> åˆ—è¡¨çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²æ‹¼æ¥è€Œæˆã€‚</li>
<li>ç´¢å¼•ç”Ÿæˆæ–¹å¼ä¸º <code>urandom(2) &amp; 0xfff</code>ï¼Œè¿™æ„å‘³ç€ç´¢å¼•èŒƒå›´æ˜¯ $0$ åˆ° $4095$ ($2^{12}-1$)ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ³„éœ²ä¿¡æ¯ (Linear Leakage)</strong>:</p>
<ul>
<li>
<p>é¢˜ç›®è¾“å‡ºäº† 600 ç»„ <code>[nonce, bit]</code>ã€‚</p>
</li>
<li>
<p>è®¡ç®—æ–¹å¼ï¼š<code>bit = (bin(nonce &amp; key).count(&quot;1&quot;)) % 2</code>ã€‚</p>
</li>
<li>
<p>æ•°å­¦æ„ä¹‰ï¼šè¿™æ˜¯ <code>nonce</code> å’Œ <code>key</code> ä¸¤ä¸ªå‘é‡åœ¨ GF(2) æœ‰é™åŸŸä¸Šçš„<strong>å†…ç§¯</strong> (Inner Product)ã€‚</p>
</li>
<li>
<p>è®¾ $K$ ä¸ºå¯†é’¥çš„äºŒè¿›åˆ¶å‘é‡ï¼Œ$N_i$ ä¸ºç¬¬ $i$ ä¸ª nonceï¼Œ$b_i$ ä¸ºç»“æœä½ï¼Œåˆ™æœ‰ï¼š<br>
$$<br>
N_i \cdot K \equiv b_i \pmod 2<br>
$$</p>
</li>
</ul>
</li>
</ol>
<p>æˆ‘ä»¬æœ‰ 600 ä¸ªæ–¹ç¨‹ã€‚å¦‚æœ Key æ˜¯å®Œå…¨éšæœºçš„ 800 ä½æ•´æ•°ï¼Œåˆ™æœ‰ 800 ä¸ªå˜é‡ã€‚ä½†è¿™å¹¶ä¸ä»£è¡¨é¢˜ç›®ä¸å¯è§£ã€‚è™½ç„¶æ¯ä¸€ä¸ª bit éƒ½åœ¨å˜ï¼Œä½†å› ä¸º <code>vecs</code> åªæœ‰ 4096 ($2^{12}$) ä¸ªå…ƒç´ ï¼Œè¿™äº› 16 ä½çš„å‘é‡åœ¨æ•°å­¦ä¸Šå¿…ç„¶æ„æˆä¸€ä¸ª <strong>ç»´åº¦ä¸è¶…è¿‡ 12 çš„çº¿æ€§å­ç©ºé—´ï¼ˆæˆ–ä»¿å°„å­ç©ºé—´ï¼‰</strong>ã€‚</p>
<ol>
<li>
<p><strong>é™ç»´åŸç†</strong>ï¼š<br>
è™½ç„¶æ¯ä¸ª Block æ˜¯ 16 bitsï¼Œä½†å®ƒä»¬æ˜¯ç”± 12 bits çš„ç´¢å¼•ç”Ÿæˆçš„ã€‚å¦‚æœ <code>vecs</code> æ˜¯çº¿æ€§ç”Ÿæˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ° <strong>12 ä¸ªåŸºå‘é‡ (Basis Vectors)</strong> æ¥è¡¨ç¤ºæ‰€æœ‰çš„ <code>vecs</code> å…ƒç´ ã€‚<br>
$$<br>
Vec = C + k_0 \cdot B_0 + k_1 \cdot B_1 + â€¦ + k_{11} \cdot B_{11}<br>
$$</p>
<ul>
<li>$C$: åç§»å‘é‡ (Offset/Base vector)ï¼Œé€šå¸¸å– <code>vecs[0]</code>ã€‚</li>
<li>$B_i$: åŸºå‘é‡ã€‚</li>
<li>$k_i$: ç³»æ•° (0 æˆ– 1)ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦è§£çš„<strong>æ–°å˜é‡</strong>ã€‚</li>
</ul>
</li>
<li>
<p><strong>å˜é‡ç»Ÿè®¡</strong>ï¼š</p>
<ul>
<li>æ–°å˜é‡ï¼š50 ä¸ª Block $\times$ 12 ä¸ªç³»æ•° = 600 ä¸ªå˜é‡ã€‚</li>
<li>æ–¹ç¨‹æ•°ï¼š600 ä¸ªã€‚</li>
<li><strong>600 = 600ï¼Œæ­¤æ—¶æ»¡ç§©å¯è§£</strong></li>
</ul>
</li>
</ol>
<p>å…·ä½“è§£é¢˜ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ast<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-comment"># ================= 1. åˆ†æ Vecs çš„çº¿æ€§ç»“æ„ =================</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Analyzing the linear structure of vecs...&quot;</span>)<br><br><span class="hljs-comment"># å°† vecs (å­—ç¬¦ä¸²åˆ—è¡¨) è½¬æ¢ä¸º GF(2) çŸ©é˜µ</span><br><span class="hljs-comment"># vecs å…ƒç´ å¦‚ &#x27;0111...&#x27;</span><br>vecs_matrix = Matrix(GF(<span class="hljs-number">2</span>), [[<span class="hljs-built_in">int</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s] <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> vecs])<br><br><span class="hljs-comment"># å–ç¬¬ä¸€ä¸ªå‘é‡ä½œä¸ºåŸºå‡†åç§»é‡ (Base Vector)</span><br>base_vec = vecs_matrix[<span class="hljs-number">0</span>]<br><br><span class="hljs-comment"># è®¡ç®—å·®åˆ†çŸ©é˜µ: &#123;v - v0&#125;</span><br>diff_vecs = [row - base_vec <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> vecs_matrix]<br>diff_matrix = Matrix(GF(<span class="hljs-number">2</span>), diff_vecs)<br><br><span class="hljs-comment"># è®¡ç®—çº¿æ€§åŸº (Basis)</span><br>basis = diff_matrix.row_space()<br>basis_vectors = basis.basis()<br><br>DIM = <span class="hljs-built_in">len</span>(basis_vectors)<br>BLOCK_LEN = vecs_matrix.ncols() <span class="hljs-comment"># åº”è¯¥æ˜¯ 16</span><br>NUM_BLOCKS = <span class="hljs-number">50</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Block Length: <span class="hljs-subst">&#123;BLOCK_LEN&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Subspace Dimension: <span class="hljs-subst">&#123;DIM&#125;</span>&quot;</span>) <span class="hljs-comment"># é¢„æœŸæ˜¯ 12</span><br><br><span class="hljs-comment"># ================= 2. æ„å»ºçº¿æ€§æ–¹ç¨‹ç»„ =================</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Building linear system...&quot;</span>)<br><br><span class="hljs-comment"># è¯»å– output.txt</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    content = f.read()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;ğŸ :&quot;</span> <span class="hljs-keyword">in</span> content:<br>        list_str = content.split(<span class="hljs-string">&quot;ğŸ :&quot;</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">&quot;\n&quot;</span>)[<span class="hljs-number">0</span>].strip()<br>    <span class="hljs-keyword">else</span>:<br>        list_str = content.strip()<br>    data = ast.literal_eval(list_str)<br><br>M = []<br>B = []<br><br><span class="hljs-keyword">for</span> nonce_int, target_bit <span class="hljs-keyword">in</span> data:<br>    row = []<br>    <br>    <span class="hljs-comment"># rhs_val ç”¨äºå­˜å‚¨æ–¹ç¨‹å³è¾¹çš„å€¼ (target - å¸¸æ•°é¡¹)</span><br>    rhs_val = <span class="hljs-built_in">int</span>(target_bit)<br>    <br>    <span class="hljs-comment"># éå† 50 ä¸ª block</span><br>    <span class="hljs-keyword">for</span> block_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(NUM_BLOCKS):<br>        <span class="hljs-comment"># æå–å½“å‰ block å¯¹åº”çš„ Nonce ç‰‡æ®µ (16 bits)</span><br>        <span class="hljs-comment"># ç§»ä½é€»è¾‘ï¼šBlock 0 æ˜¯æœ€é«˜ä½</span><br>        shift_amount = (NUM_BLOCKS - <span class="hljs-number">1</span> - block_idx) * BLOCK_LEN<br>        nonce_chunk = (nonce_int &gt;&gt; shift_amount) &amp; ((<span class="hljs-number">1</span> &lt;&lt; BLOCK_LEN) - <span class="hljs-number">1</span>)<br>        <br>        <span class="hljs-comment"># å°† nonce_chunk è½¬ä¸º Sage å‘é‡</span><br>        <span class="hljs-comment"># æ³¨æ„ä½åºï¼šå­—ç¬¦ä¸² index 0 æ˜¯æœ€é«˜ä½</span><br>        nonce_vec = vector(GF(<span class="hljs-number">2</span>), [(nonce_chunk &gt;&gt; (BLOCK_LEN - <span class="hljs-number">1</span> - i)) &amp; <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BLOCK_LEN)])<br>        <br>        <span class="hljs-comment"># 1. è®¡ç®—å¸¸æ•°éƒ¨åˆ†çš„è´¡çŒ® (Offset Contribution)</span><br>        <span class="hljs-comment"># dot_product ç»“æœæ˜¯ GF(2) å…ƒç´ ï¼Œå¿…é¡»è½¬ä¸º int</span><br>        const_contribution = <span class="hljs-built_in">int</span>(nonce_vec * base_vec)<br>        <br>        <span class="hljs-comment"># æ›´æ–° RHS: å‡å»å¸¸æ•°é¡¹ (åœ¨ GF(2) ä¸­å‡æ³•ç­‰äºåŠ æ³•)</span><br>        rhs_val = (rhs_val + const_contribution) % <span class="hljs-number">2</span><br>        <br>        <span class="hljs-comment"># 2. è®¡ç®—å˜é‡ç³»æ•° (Coefficients of Basis)</span><br>        <span class="hljs-keyword">for</span> basis_vec <span class="hljs-keyword">in</span> basis_vectors:<br>            <span class="hljs-comment"># è®¡ç®— nonce å¯¹è¯¥åŸºå‘é‡çš„æŠ•å½±</span><br>            coeff = <span class="hljs-built_in">int</span>(nonce_vec * basis_vec)<br>            row.append(coeff)<br>            <br>    M.append(row)<br>    B.append(rhs_val)<br><br><span class="hljs-comment"># ================= 3. æ±‚è§£ =================</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Solving with SageMath...&quot;</span>)<br>MS = Matrix(GF(<span class="hljs-number">2</span>), M)<br>VS = vector(GF(<span class="hljs-number">2</span>), B)<br><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-comment"># solve_right æ±‚è§£ M * x = B</span><br>    coeffs = MS.solve_right(VS)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Solution found!&quot;</span>)<br>    <br>    <span class="hljs-comment"># ================= 4. é‡ç»„ Key =================</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Reconstructing Key...&quot;</span>)<br>    <br>    full_key_bits = <span class="hljs-string">&quot;&quot;</span><br>    <br>    <span class="hljs-comment"># éå† 50 ä¸ª Blockï¼Œåˆ©ç”¨è§£å‡ºçš„ç³»æ•°é‡å»ºæ¯ä¸ª Block</span><br>    <span class="hljs-keyword">for</span> block_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(NUM_BLOCKS):<br>        <span class="hljs-comment"># å–å‡ºå½“å‰ Block å¯¹åº”çš„ DIM (12) ä¸ªç³»æ•°</span><br>        block_coeffs = coeffs[block_idx*DIM : (block_idx+<span class="hljs-number">1</span>)*DIM]<br>        <br>        <span class="hljs-comment"># é‡å»ºå‘é‡: V = Base + Sum(c_i * B_i)</span><br>        recovered_vec = base_vec<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(DIM):<br>            <span class="hljs-keyword">if</span> block_coeffs[i] == <span class="hljs-number">1</span>:<br>                recovered_vec += basis_vectors[i]<br>        <br>        <span class="hljs-comment"># å°†å‘é‡è½¬å› &#x27;01&#x27; å­—ç¬¦ä¸²</span><br>        vec_str = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> recovered_vec)<br>        full_key_bits += vec_str<br>        <br>    key_int = <span class="hljs-built_in">int</span>(full_key_bits, <span class="hljs-number">2</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Recovered Key: <span class="hljs-subst">&#123;key_int&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># ================= 5. è§£å¯† Flag =================</span><br>    aes_key = md5(<span class="hljs-built_in">str</span>(key_int).encode()).digest()<br><br>    ciphertext = <span class="hljs-string">b&#x27;r\x9f\xa5N\x19\xa3\x8b-\xfen\xa7\xc9\xca\x87\x04\x873#ju\xc5\x06\xd0\x85L\x1ab\xa1XEre\xe5\x8c:h&#x27;</span><br>    cipher = AES.new(key=aes_key, nonce=<span class="hljs-string">b&quot;Tiffany&quot;</span>, mode=AES.MODE_CTR)<br>    flag = cipher.decrypt(ciphertext)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ğŸš© FLAG: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">except</span> ValueError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] No solution found. System might be inconsistent.&quot;</span>)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] An error occurred during reconstruction/decryption: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p>
<img src="/2026/03/01/LilCTF2025wp/4.png" srcset="/img/loading.gif" lazyload class="">
<h2 id="Linear">Linear</h2>
<p>æ„é€ æ ¼æ±‚è§£ï¼Œå…·ä½“çš„æ„é€ å†™åœ¨è„šæœ¬æ³¨é‡Šä¸­äº†ã€‚å¥½å§ï¼Œå…¶å®æ˜¯æˆ‘ä¸ä¼šï¼ˆï¼‰ï¼ŒGemini ç‹æœäº†ã€‚</p>
<p>æ±‚è§£ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> ast<br><br>HOST,PORT = <span class="hljs-string">&quot;challenge.imxbt.cn&quot;</span> , <span class="hljs-number">31501</span><br>io = remote(HOST, PORT)<br><br><span class="hljs-comment"># æ¥æ”¶ A (æ ¼å¼: [[...]])</span><br>io.recvuntil(<span class="hljs-string">b&quot;[[&quot;</span>)<br>raw_A_str = <span class="hljs-string">&quot;[[&quot;</span> + io.recvuntil(<span class="hljs-string">b&quot;]]&quot;</span>).decode()<br>A_list = ast.literal_eval(raw_A_str)<br><span class="hljs-comment"># æ¥æ”¶ b (æ ¼å¼: [...])</span><br>io.recvuntil(<span class="hljs-string">b&quot;[&quot;</span>)<br>raw_b_str = <span class="hljs-string">&quot;[&quot;</span> + io.recvuntil(<span class="hljs-string">b&quot;]&quot;</span>).decode()<br>b_list = ast.literal_eval(raw_b_str)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_sis</span>():<br><br>    <span class="hljs-comment"># å®šä¹‰çŸ©é˜µå’Œå‘é‡</span><br>    <span class="hljs-comment"># è¿™é‡Œä½¿ç”¨ ZZ (æ•´æ•°ç¯)</span><br>    A = Matrix(ZZ, A_list)<br>    b = vector(ZZ, b_list)<br>    <br>    nrows = A.nrows()   <span class="hljs-comment"># 16</span><br>    ncols = A.ncols()   <span class="hljs-comment"># 32</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] æ­£åœ¨åˆå§‹åŒ–æ ¼çŸ©é˜µ (Rows: <span class="hljs-subst">&#123;nrows&#125;</span>, Cols: <span class="hljs-subst">&#123;ncols&#125;</span>)...&quot;</span>)<br><br>    <span class="hljs-comment"># -----------------------------------------------------</span><br>    <span class="hljs-comment"># æ„é€ æ ¼ (Lattice Construction) - Embedding Method</span><br>    <span class="hljs-comment"># -----------------------------------------------------</span><br>    <span class="hljs-comment"># æˆ‘ä»¬æ„é€ ä¸€ä¸ªçŸ©é˜µ Mï¼Œå½¢å¼å¦‚ä¸‹ï¼š</span><br>    <span class="hljs-comment"># [ I  |  K * A^T ]</span><br>    <span class="hljs-comment"># [ 0  | -K * b^T ]</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># è¿™é‡Œçš„ K æ˜¯ä¸€ä¸ªå·¨å¤§çš„æƒé‡ã€‚</span><br>    <span class="hljs-comment"># å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå‘é‡ v = (x_1, ..., x_32, 1)</span><br>    <span class="hljs-comment"># v * M = (x, K(Ax - b))</span><br>    <span class="hljs-comment"># å¦‚æœ Ax = bï¼Œé‚£ä¹ˆç»“æœå‘é‡çš„å³åŠéƒ¨åˆ†å°†å…¨éƒ¨ä¸º 0ã€‚</span><br>    <span class="hljs-comment"># LLL ç®—æ³•ä¼šå¯»æ‰¾çŸ­å‘é‡ï¼Œå› ä¸º x å¾ˆå°è€Œ K å¾ˆå¤§ï¼Œç®—æ³•ä¼šä¼˜å…ˆå¼ºåˆ¶å³åŠéƒ¨åˆ†ä¸º 0ã€‚</span><br>    <span class="hljs-comment"># -----------------------------------------------------</span><br><br>    <span class="hljs-comment"># æƒé‡ Kï¼šå¿…é¡»è¶³å¤Ÿå¤§ï¼Œä½¿å¾—æ»¡è¶³æ–¹ç¨‹çº¦æŸæ¯”å‡å° x çš„æ•°å€¼æ›´é‡è¦ã€‚</span><br>    <span class="hljs-comment"># x çš„æœ€å¤§å€¼çº¦ 10^5ï¼ŒK å– 10^10 ä»¥ä¸Šæ¯”è¾ƒå®‰å…¨ã€‚</span><br>    K = <span class="hljs-number">2</span>**<span class="hljs-number">60</span> <br>    <br>    <span class="hljs-comment"># æ„é€ çŸ©é˜µ M</span><br>    <span class="hljs-comment"># ç»´åº¦ï¼š(32ä¸ªå˜é‡ + 1ä¸ªå¸¸æ•°é¡¹) è¡Œï¼Œ (32åˆ—å­˜x + 16åˆ—å­˜çº¦æŸ) åˆ—</span><br>    M = Matrix(ZZ, ncols + <span class="hljs-number">1</span>, ncols + nrows)<br>    <br>    <span class="hljs-comment"># 1. å·¦ä¸Šè§’ï¼šå•ä½çŸ©é˜µ I (ç”¨äºä¿æŒ x çš„å€¼)</span><br>    M.set_block(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, Matrix.identity(ncols))<br>    <br>    <span class="hljs-comment"># 2. å³ä¸Šè§’ï¼šK * A^T (æ–¹ç¨‹ç³»æ•°)</span><br>    M.set_block(<span class="hljs-number">0</span>, ncols, K * A.transpose())<br>    <br>    <span class="hljs-comment"># 3. æœ€åä¸€è¡Œï¼šå¸¸æ•°é¡¹å¤„ç†</span><br>    <span class="hljs-comment"># å·¦ä¸‹è§’æ˜¯ 0 (é»˜è®¤å°±æ˜¯0ï¼Œä¸ç”¨è®¾)</span><br>    <span class="hljs-comment"># å³ä¸‹è§’æ˜¯ -K * b (æ–¹ç¨‹çš„å¸¸æ•°é¡¹ç§»é¡¹)</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows):<br>        M[ncols, ncols + i] = -K * b[i]<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] æ­£åœ¨è¿è¡Œ LLL ç®—æ³• (è¿™å¯èƒ½éœ€è¦å‡ ç§’é’Ÿ)...&quot;</span>)<br>    <br>    <span class="hljs-comment"># è¿è¡Œ LLL è§„çº¦</span><br>    L_reduced = M.LLL()<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] LLL å®Œæˆï¼Œæ­£åœ¨æœç´¢è§£å‘é‡...&quot;</span>)<br><br>    solution = <span class="hljs-literal">None</span><br>    <br>    <span class="hljs-comment"># éå†è§„çº¦ååŸºåº•çš„æ¯ä¸€è¡Œ</span><br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> L_reduced:<br>        <span class="hljs-comment"># æå–å‘é‡çš„å³åŠéƒ¨åˆ† (åº”è¯¥å…¨ä¸º 0)</span><br>        check_part = row[ncols:]<br>        <br>        <span class="hljs-comment"># æå–å‘é‡çš„å·¦åŠéƒ¨åˆ† (å¯èƒ½æ˜¯è§£ x)</span><br>        x_part = row[:ncols]<br>        <br>        <span class="hljs-comment"># æ£€æŸ¥1ï¼šçº¦æŸéƒ¨åˆ†æ˜¯å¦å…¨ä¸º 0</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> check_part.is_zero():<br>            <span class="hljs-keyword">continue</span><br>            <br>        <span class="hljs-comment"># æ£€æŸ¥2ï¼šx éƒ¨åˆ†ä¸èƒ½å…¨ä¸º 0</span><br>        <span class="hljs-keyword">if</span> x_part.is_zero():<br>            <span class="hljs-keyword">continue</span><br>            <br>        <span class="hljs-comment"># ä¿®æ­£ç¬¦å·ï¼šLLL å¯èƒ½ä¼šè¿”å› -x</span><br>        <span class="hljs-comment"># é¢˜ç›®ä¸­ x æ˜¯æ­£æ•´æ•°ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å‘ç°å¤§éƒ¨åˆ†æ˜¯è´Ÿæ•°ï¼Œå°±å–å</span><br>        <span class="hljs-comment"># ç®€å•çš„å¯å‘å¼ï¼šçœ‹ç¬¬ä¸€ä¸ªéé›¶å…ƒç´ æ˜¯å¦ä¸ºè´Ÿ</span><br>        <span class="hljs-keyword">if</span> x_part[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">0</span>:<br>            x_part = -x_part<br>            <br>        <span class="hljs-comment"># æ£€æŸ¥3ï¼šä»£å›éªŒè¯ Ax = b</span><br>        <span class="hljs-comment"># å°† vector è½¬æ¢ä¸º list æ–¹ä¾¿è®¡ç®—</span><br>        x_candidate = <span class="hljs-built_in">list</span>(x_part)<br>        <br>        <span class="hljs-comment"># éªŒè¯</span><br>        recalc_b = [<span class="hljs-built_in">sum</span>(A_list[i][j] * x_candidate[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows)]<br>        <br>        <span class="hljs-keyword">if</span> recalc_b == b_list:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] æˆåŠŸæ‰¾åˆ°è§£ï¼&quot;</span>)<br>            solution = x_candidate<br>            <span class="hljs-keyword">break</span><br>    <br>    <span class="hljs-keyword">if</span> solution:<br>        x = <span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, solution))<br>        <span class="hljs-built_in">print</span>(x)<br>        io.sendlineafter(<span class="hljs-string">b&quot;Enter your solution: &quot;</span>, x.encode())<br>        <span class="hljs-built_in">print</span>(io.recvall().decode())<br>        io.close()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] æœªæ‰¾åˆ°è§£ã€‚å¯èƒ½åŸå› ï¼š&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;2. æƒé‡ K ä¸å¤Ÿå¤§ (å°è¯•å¢å¤§ K)&quot;</span>)<br><br><span class="hljs-comment"># æ‰§è¡Œ</span><br>solve_sis()<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p>
<img src="/2026/03/01/LilCTF2025wp/5.png" srcset="/img/loading.gif" lazyload class="">
<h2 id="baaaaag">baaaaag</h2>
<p>å¯ä»¥å‘ç°æ˜¯éå¸¸åŸå§‹çš„èƒŒåŒ…åŠ å¯†ç³»ç»Ÿï¼Œç›´æ¥é€ æ ¼æ‰“ LLL ä¼šå‘ç°å‡ºä¸äº†ç»“æœï¼Œä½†æ˜¯ä½¿ç”¨æ›´å¼ºçš„ BKZï¼Œç„¶å block_size è®¾ç½®çš„ç¨å¾®å¤§ä¸€ç‚¹å°±èƒ½å‡ºã€‚</p>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-comment"># ==========================================</span><br><span class="hljs-comment"># é¢˜ç›®æ•°æ®</span><br><span class="hljs-comment"># ==========================================</span><br>a = [<span class="hljs-number">965032030645819473226880279</span>, <span class="hljs-number">699680391768891665598556373</span>, <span class="hljs-number">1022177754214744901247677527</span>, <span class="hljs-number">680767714574395595448529297</span>, <span class="hljs-number">1051144590442830830160656147</span>, <span class="hljs-number">1168660688736302219798380151</span>, <span class="hljs-number">796387349856554292443995049</span>, <span class="hljs-number">740579849809188939723024937</span>, <span class="hljs-number">940772121362440582976978071</span>, <span class="hljs-number">787438752754751885229607747</span>, <span class="hljs-number">1057710371763143522769262019</span>, <span class="hljs-number">792170184324681833710987771</span>, <span class="hljs-number">912844392679297386754386581</span>, <span class="hljs-number">906787506373115208506221831</span>, <span class="hljs-number">1073356067972226734803331711</span>, <span class="hljs-number">1230248891920689478236428803</span>, <span class="hljs-number">713426848479513005774497331</span>, <span class="hljs-number">979527247256538239116435051</span>, <span class="hljs-number">979496765566798546828265437</span>, <span class="hljs-number">836939515442243300252499479</span>, <span class="hljs-number">1185281999050646451167583269</span>, <span class="hljs-number">673490198827213717568519179</span>, <span class="hljs-number">776378201435505605316348517</span>, <span class="hljs-number">809920773352200236442451667</span>, <span class="hljs-number">1032450692535471534282750757</span>, <span class="hljs-number">1116346000400545215913754039</span>, <span class="hljs-number">1147788846283552769049123803</span>, <span class="hljs-number">994439464049503065517009393</span>, <span class="hljs-number">825645323767262265006257537</span>, <span class="hljs-number">1076742721724413264636318241</span>, <span class="hljs-number">731782018659142904179016783</span>, <span class="hljs-number">656162889354758353371699131</span>, <span class="hljs-number">1045520414263498704019552571</span>, <span class="hljs-number">1213714972395170583781976983</span>, <span class="hljs-number">949950729999198576080781001</span>, <span class="hljs-number">1150032993579134750099465519</span>, <span class="hljs-number">975992662970919388672800773</span>, <span class="hljs-number">1129148699796142943831843099</span>, <span class="hljs-number">898871798141537568624106939</span>, <span class="hljs-number">997718314505250470787513281</span>, <span class="hljs-number">631543452089232890507925619</span>, <span class="hljs-number">831335899173370929279633943</span>, <span class="hljs-number">1186748765521175593031174791</span>, <span class="hljs-number">884252194903912680865071301</span>, <span class="hljs-number">1016020417916761281986717467</span>, <span class="hljs-number">896205582917201847609656147</span>, <span class="hljs-number">959440423632738884107086307</span>, <span class="hljs-number">993368100536690520995612807</span>, <span class="hljs-number">702602277993849887546504851</span>, <span class="hljs-number">1102807438605649402749034481</span>, <span class="hljs-number">629539427333081638691538089</span>, <span class="hljs-number">887663258680338594196147387</span>, <span class="hljs-number">1001965883259152684661493409</span>, <span class="hljs-number">1043811683483962480162133633</span>, <span class="hljs-number">938713759383186904819771339</span>, <span class="hljs-number">1023699641268310599371568653</span>, <span class="hljs-number">784025822858960757703945309</span>, <span class="hljs-number">986182634512707587971047731</span>, <span class="hljs-number">1064739425741411525721437119</span>, <span class="hljs-number">1209428051066908071290286953</span>, <span class="hljs-number">667510673843333963641751177</span>, <span class="hljs-number">642828919542760339851273551</span>, <span class="hljs-number">1086628537309368288204342599</span>, <span class="hljs-number">1084848944960506663668298859</span>, <span class="hljs-number">667827295200373631038775959</span>, <span class="hljs-number">752634137348312783761723507</span>, <span class="hljs-number">707994297795744761368888949</span>, <span class="hljs-number">747998982630688589828284363</span>, <span class="hljs-number">710184791175333909291593189</span>, <span class="hljs-number">651183930154725716807946709</span>, <span class="hljs-number">724836607223400074343868079</span>, <span class="hljs-number">1118993538091590299721647899</span>]<br>b = <span class="hljs-number">34962396275078207988771864327</span><br>ciphertext = <span class="hljs-string">b&#x27;Lo~G\xf46&gt;\xd609\x8e\x8e\xf5\xf83\xb5\xf0\x8f\x9f6&amp;\xea\x02\xfa\xb1_L\x85\x93\x93\xf7,`|\xc6\xbe\x05&amp;\x85\x8bC\xcd\xe6?TV4q&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    n = <span class="hljs-built_in">len</span>(a)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] Problem dimension: n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># ä½¿ç”¨æå…¶å·¨å¤§çš„æƒé‡ Kï¼Œå½»åº•æ¶ˆé™¤éƒ¨åˆ†å’Œçš„å±€éƒ¨æå°å€¼å¹²æ‰°</span><br>    K = <span class="hljs-number">2</span>**<span class="hljs-number">200</span> <br>    <br>    <span class="hljs-comment"># æ„é€ ç²¾ç¡®çš„ (n+1) x (n+1) çŸ©é˜µ</span><br>    M = Matrix(ZZ, n + <span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>)<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[i, i] = <span class="hljs-number">2</span>          <span class="hljs-comment"># å¯¹è§’çº¿ä¸º 2</span><br>        M[i, n] = K * a[i]   <span class="hljs-comment"># æœ€åä¸€åˆ—ä¹˜ä»¥å·¨å¤§æƒé‡ K</span><br>        <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[n, i] = <span class="hljs-number">1</span>          <span class="hljs-comment"># æœ€åä¸€è¡Œå‰ n åˆ—ä¸º 1</span><br>    M[n, n] = K * b          <span class="hljs-comment"># å³ä¸‹è§’ä¸º K * b</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Reconstructed highly weighted CJLOSS lattice.&quot;</span>)<br>    <br>    <span class="hljs-comment"># æ£€æŸ¥çŸ©é˜µå¹¶æå– p çš„å‡½æ•°</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">check_matrix</span>(<span class="hljs-params">B_mat</span>):<br>        <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> B_mat:<br>            <span class="hljs-comment"># ä¸¥æ ¼æ£€æŸ¥æœ€åä¸€åˆ—æ˜¯å¦ä¸º0ï¼ˆç”±äºæƒé‡Kæå¤§ï¼Œè¿™é‡Œä¸º0æ„å‘³ç€100%æ»¡è¶³èƒŒåŒ…å’Œï¼‰</span><br>            <span class="hljs-keyword">if</span> row[n] != <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br>                <br>            vec = row[:n]<br>            <span class="hljs-comment"># æ£€æŸ¥å‰né¡¹æ˜¯å¦å…¨ä¸º 1 æˆ– -1</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">all</span>(<span class="hljs-built_in">abs</span>(v) == <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> vec):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Found short vector (1/-1): <span class="hljs-subst">&#123;vec[:<span class="hljs-number">10</span>]&#125;</span>...&quot;</span>)<br>                <br>                <span class="hljs-comment"># æ ¼åŸºè§„çº¦å¯èƒ½æ‰¾åˆ°ç›®æ ‡å‘é‡ï¼Œä¹Ÿå¯èƒ½æ‰¾åˆ°å®ƒçš„ç›¸åæ•° (-vec)</span><br>                <span class="hljs-comment"># å› æ­¤æˆ‘ä»¬ç”Ÿæˆä¸¤ç§æƒ…å†µè¿›è¡Œæµ‹è¯•</span><br>                x_candidates = [<br>                    [(v + <span class="hljs-number">1</span>) // <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> vec],<br>                    [(-v + <span class="hljs-number">1</span>) // <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> vec]<br>                ]<br>                <br>                <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> x_candidates:<br>                    calc_sum = <span class="hljs-built_in">sum</span>(x[i] * a[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n))<br>                    <span class="hljs-keyword">if</span> calc_sum == b:<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Subset sum verified successfully!&quot;</span>)<br>                        <br>                        <span class="hljs-comment"># è¿˜åŸ p</span><br>                        p = <span class="hljs-number">0</span><br>                        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>                            p += <span class="hljs-built_in">int</span>(x[i]) * (<span class="hljs-number">1</span> &lt;&lt; i)<br>                            <br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] Recovered p: <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br>                        <br>                        <span class="hljs-comment"># è§£å¯†</span><br>                        key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()<br>                        cipher = AES.new(key, AES.MODE_ECB)<br>                        <span class="hljs-keyword">try</span>:<br>                            pt = cipher.decrypt(ciphertext)<br>                            flag = unpad(pt, <span class="hljs-number">16</span>).decode()<br>                            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[SUCCESS] FLAG: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>                            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>                        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] Padding error during decryption: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    block_size  = <span class="hljs-number">30</span><br>    B_bkz = M.BKZ(block_size=block_size)<br>    <span class="hljs-keyword">if</span> check_matrix(B_bkz):<br>        <span class="hljs-keyword">return</span><br>            <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[-] All lattice reduction techniques failed. Please check the inputs.&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    solve()<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p>
<img src="/2026/03/01/LilCTF2025wp/6.png" srcset="/img/loading.gif" lazyload class="">
<p>è¯¦ç»†çš„é¢˜ç›®æ–‡ä»¶ä¸è§£é¢˜è„šæœ¬ä»¥åŠ <strong>WriteUp</strong> çš„ pdf å¯ä»¥é€šè¿‡å…³äºé¡µä¸­æˆ‘çš„ GitHub ä»“åº“æ‰¾åˆ°ã€‚</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%81%9A%E9%A2%98%E5%A4%8D%E7%8E%B0/" class="category-chain-item">åšé¢˜å¤ç°</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/CTF/" class="print-no-link">#CTF</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>LilCTF2025wp</div>
      <div>https://zijeff.github.io/2026/03/01/LilCTF2025wp/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>zijeff</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2026å¹´3æœˆ1æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2026/02/27/0xFunCTF2026wp/" title="0xFunCTF2026wp">
                        <span class="hidden-mobile">0xFunCTF2026wp</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
