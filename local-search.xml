<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>LilCTF2025wp</title>
    <link href="/2026/03/01/LilCTF2025wp/"/>
    <url>/2026/03/01/LilCTF2025wp/</url>
    
    <content type="html"><![CDATA[<h2 id="Warm-Up">Warm Up</h2><p>æˆ‘ä»¬æ¥é€è¡Œåˆ†æé¢˜ç›®ï¼š</p><ol><li><p><strong>å¯†é’¥æ˜¯å›ºå®šçš„</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">key = Random(<span class="hljs-number">2025</span>).randbytes(<span class="hljs-number">16</span>)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨äº† random åº“ï¼ˆæ¢…æ£®æ—‹è½¬ç®—æ³•ï¼‰ï¼Œå¹¶ä¸”æŒ‡å®šäº†ç§å­ 2025ã€‚è¿™æ„å‘³ç€æ— è®ºä½•æ—¶è¿è¡Œè¿™æ®µä»£ç ï¼Œç”Ÿæˆçš„ key éƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è§£å¯†è„šæœ¬ä¸­ç”ŸæˆåŒæ ·çš„ Keyã€‚</p></li><li><p><strong>CBCæ¨¡å¼çš„IVä¾èµ–äºæ˜æ–‡</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">AES.new(key, AES.MODE_CBC, iv=FLAG[<span class="hljs-number">9</span>:<span class="hljs-number">25</span>])<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨äº† AES çš„ CBC æ¨¡å¼ã€‚</p><ul><li><strong>Key</strong>: å·²çŸ¥ã€‚</li><li><strong>IV (åˆå§‹åŒ–å‘é‡)</strong>: å–è‡ª FLAG çš„ç¬¬ 9 åˆ° 25 ä¸ªå­—èŠ‚ (FLAG[9:25])ã€‚</li><li><strong>Plaintext</strong>: å¡«å……åçš„ FLAGã€‚</li></ul></li></ol><p>è€Œ <strong>AES-CBC</strong> æ¨¡å¼çš„è§£å¯†è¿‡ç¨‹å¦‚ä¸‹ï¼š<br>$$<br>P_i = D_k(C_i)\oplus C_{i-1}<br>$$<br>å…¶ä¸­ï¼Œ$C_i$ æ˜¯å¯†æ–‡å—ï¼Œ$P_i$ æ˜¯æ˜æ–‡å—ï¼Œ$D_k$ æ˜¯è§£å¯†å‡½æ•°ã€‚ç‰¹æ®Šåœ°ï¼Œ$C_{-1}$ å°±æ˜¯åˆå§‹åŒ–å‘é‡ã€‚</p><p>å‡è®¾ Flag é•¿åº¦ç»è¿‡å¡«å……åè¢«åˆ†ä¸º $P_0, P_1, P_2â€¦$ å‡ ä¸ªå—ï¼ˆæ¯å—16å­—èŠ‚ï¼‰ï¼Œå¯†æ–‡åˆ†ä¸º $C_0, C_1, C_2â€¦$ã€‚</p><p><strong>å¯¹äºé™¤äº†ç¬¬ä¸€å—ä»¥å¤–çš„æ‰€æœ‰å— ($i &gt; 0$)ï¼š</strong><br>$$<br>P_i = Dec_{key}(C_i) \oplus C_{i-1}<br>$$<br>å› ä¸º Key æ˜¯å·²çŸ¥çš„ï¼Œä¸”å¯†æ–‡ $C$â€‹ æ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥<strong>ç›´æ¥è§£å¯†å‡ºé™¤äº†ç¬¬ä¸€å—ä»¥å¤–çš„æ‰€æœ‰æ˜æ–‡</strong>ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çŸ¥é“äº† <strong>FLAG[16:]</strong> çš„æ‰€æœ‰å†…å®¹ã€‚</p><p><strong>å¯¹äºç¬¬ä¸€å— ($P_0$)ï¼š</strong><br>$$<br>P_0 = Dec_{key}(C_0) \oplus IV<br>$$<br>è¿™é‡Œ $P_0$ æ˜¯ <strong>FLAG[0:16]</strong>ï¼Œ$IV$ æ˜¯ <strong>FLAG[9:25]</strong>ã€‚ä»¤ä¸­é—´çŠ¶æ€ $X_0 = Dec_{key}(C_0)$ï¼ˆè¿™æ˜¯æˆ‘ä»¬èƒ½ç®—å‡ºæ¥çš„ï¼‰ï¼Œé‚£ä¹ˆåˆ™æœ‰ï¼š<br>$$<br>FLAG[0:16] = X_0 \oplus FLAG[9:25]<br>$$<br>å¦‚æœæˆ‘ä»¬æŒ‰å­—èŠ‚æ¥çœ‹è¿™ä¸ªå¼‚æˆ–å…³ç³»ï¼ˆè®¾ $f_i$ ä¸º Flag çš„ç¬¬ $i$ ä¸ªå­—èŠ‚ï¼‰ï¼š<br>$$<br>f_i = X_0[i] \oplus f_{i+9} \quad (\text{å¯¹äº } 0 \le i \le 15)<br>$$<br>è¿™å°±æ˜¯è§£é¢˜çš„å…³é”®ï¼š</p><ol><li>æˆ‘ä»¬é€šè¿‡è§£å¯† $C_1, C_2â€¦$ å·²ç»çŸ¥é“äº† $f_{16}$ åŠå…¶ä¹‹åçš„æ‰€æœ‰å­—èŠ‚ã€‚</li><li>åˆ©ç”¨å…¬å¼ $f_i = X_0[i] \oplus f_{i+9}$ï¼š<ul><li>å½“ $i=7$ æ—¶ï¼š$f_7 = X_0[7] \oplus f_{16}$ã€‚å› ä¸º $f_{16}$ å·²çŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç®—å‡º $f_7$ã€‚</li><li>ä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç®—å‡º $f_7$ åˆ° $f_{15}$ï¼ˆåˆ©ç”¨å·²çŸ¥çš„ $f_{16}$ åˆ° $f_{24}$ï¼‰ã€‚</li></ul></li><li>ä¸€æ—¦æˆ‘ä»¬çŸ¥é“äº† $f_9$ åˆ° $f_{15}$ï¼Œæˆ‘ä»¬å†æ¬¡åˆ©ç”¨å…¬å¼ï¼š<ul><li>å½“ $i=0$ æ—¶ï¼š$f_0 = X_0[0] \oplus f_9$ã€‚å› ä¸º $f_9$ åˆšæ‰ç®—å‡ºæ¥äº†ï¼Œæ‰€ä»¥ $f_0$ å¯æ±‚ã€‚</li><li>ä»¥æ­¤ç±»æ¨ï¼Œç®—å‡º $f_0$ åˆ° $f_6$ã€‚</li></ul></li></ol><p>æ‰€ä»¥ï¼Œè§£é¢˜ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    ciphertext_hex = <span class="hljs-string">&quot;ae39cfab1ba8d38fc3761216c393caf16e3c3f13fe57e2dedd52f1b13072fa93df405c7e731a193cabe5fd88ee3241f79aded62d139faba8c767a3b8efc5a855&quot;</span> <br>    <br>    ct = <span class="hljs-built_in">bytes</span>.fromhex(ciphertext_hex)<br><br>    key = Random(<span class="hljs-number">2025</span>).randbytes(<span class="hljs-number">16</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Recovered Key: <span class="hljs-subst">&#123;key.<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># æˆ‘ä»¬ä½¿ç”¨ ECB æ¨¡å¼æ¥æ‰‹åŠ¨å¤„ç†æ¯ä¸ªå—çš„è§£å¯†å’Œå¼‚æˆ–æ“ä½œ</span><br>    aes_ecb = AES.new(key, AES.MODE_ECB)<br><br>    plaintext_suffix = <span class="hljs-string">b&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>, <span class="hljs-built_in">len</span>(ct), <span class="hljs-number">16</span>):<br>        curr_blk = ct[i:i+<span class="hljs-number">16</span>]<br>        prev_blk = ct[i-<span class="hljs-number">16</span>:i]<br>        <br>        dec_out = aes_ecb.decrypt(curr_blk)<br>        pt_blk = <span class="hljs-built_in">bytes</span>(a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(dec_out, prev_blk))<br>        plaintext_suffix += pt_blk<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Recovered suffix (block 1+): <span class="hljs-subst">&#123;plaintext_suffix&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># æˆ‘ä»¬æ„å»ºä¸€ä¸ªåˆ—è¡¨æ¥å­˜æ”¾ flagï¼Œç›®å‰å·²çŸ¥çš„æ˜¯ suffix éƒ¨åˆ†</span><br>    <span class="hljs-comment"># å‰16ä¸ªå­—èŠ‚åˆå§‹åŒ–ä¸º0</span><br>    flag_bytes = <span class="hljs-built_in">list</span>(<span class="hljs-string">b&#x27;\x00&#x27;</span> * <span class="hljs-number">16</span>) + <span class="hljs-built_in">list</span>(plaintext_suffix)<br>    <br>    <span class="hljs-comment"># è®¡ç®—ç¬¬ä¸€å—å¯†æ–‡ç»è¿‡ AES è§£å¯†åçš„ä¸­é—´çŠ¶æ€ X0</span><br>    <span class="hljs-comment"># P0 = X0 ^ IV  =&gt;  flag[0:16] = X0 ^ flag[9:25]</span><br>    x0 = aes_ecb.decrypt(ct[<span class="hljs-number">0</span>:<span class="hljs-number">16</span>])<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>, <span class="hljs-number">16</span>):<br>        flag_bytes[i] = x0[i] ^ flag_bytes[i+<span class="hljs-number">9</span>]<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>):<br>        flag_bytes[i] = x0[i] ^ flag_bytes[i+<span class="hljs-number">9</span>]<br><br>    full_flag_padded = <span class="hljs-built_in">bytes</span>(flag_bytes)<br>    <span class="hljs-keyword">try</span>:<br>        flag = unpad(full_flag_padded, <span class="hljs-number">16</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[SUCCESS] FLAG: <span class="hljs-subst">&#123;flag.decode()&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] Padding error or logic error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Raw recovered bytes: <span class="hljs-subst">&#123;full_flag_padded&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    solve()<br></code></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p><img src="/2026/03/01/LilCTF2025wp/1.png" class=""><h2 id="ez-math">ez_math</h2><h1>æˆ‘ä»¬å·²çŸ¥ A å‘é‡ï¼Œä¸ºäº†åç»­æ–¹ä¾¿è¿ç®—ï¼Œæˆ‘ä»¬å†™æˆåˆ—å‘é‡çš„å½¢å¼ï¼š<br>$$<br>A =<br>\begin{bmatrix}<br>v_1 \newline<br>v_2<br>\end{bmatrix}<br>$$<br>æˆ‘ä»¬æ ¹æ® B çš„ç”Ÿæˆæ–¹å¼ï¼Œå¯ä»¥å°†å…¶è¿›è¡Œåˆ†è§£æˆä¸¤ä¸ªçŸ©é˜µç›¸ä¹˜çš„å½¢å¼ï¼š<br>$$<br>B =<br>\begin{bmatrix}<br>v_1\lambda_1 \newline<br>v_2\lambda_2<br>\end{bmatrix}</h1><h1>\begin{bmatrix}<br>\lambda_1 &amp; 0 \newline<br>0 &amp; \lambda_2<br>\end{bmatrix}<br>\begin{bmatrix}<br>v_1 \newline<br>v_2<br>\end{bmatrix}</h1><p>\begin{bmatrix}<br>\lambda_1 &amp; 0 \newline<br>0 &amp; \lambda_2<br>\end{bmatrix}<br>A<br>$$<br>ç„¶åå†è§‚å¯Ÿç”Ÿæˆçš„ Cï¼Œå¯ä»¥å‘ç°è²Œä¼¼æ‰¾åˆ°äº†æ€è·¯ï¼š<br>$$<br>C = A^{-1}B=A^{-1}<br>\begin{bmatrix}<br>\lambda_1 &amp; 0 \newline<br>0 &amp; \lambda_2<br>\end{bmatrix}<br>A<br>$$<br>æˆ‘ä»¬è®¾<br>$$<br>D=<br>\begin{bmatrix}<br>\lambda_1 &amp; 0 \newline<br>0 &amp; \lambda_2<br>\end{bmatrix}<br>$$<br>ä¸Šè¿°çš„åˆ†æè¯´æ˜ï¼ŒC å’Œ D çŸ©é˜µç›¸ä¼¼ï¼Œç”±ç›¸ä¼¼çŸ©é˜µçš„ç‰¹æ€§å¯çŸ¥å…¶ç‰¹å¾å€¼ä¸€æ ·ã€‚é‚£ä¹ˆç›´æ¥æ±‚ C çš„ç‰¹å¾å€¼å³å¯ï¼Œå†è½¬æ¢ä¸º ASCII å­—ç¬¦ä¾¿èƒ½è·å–åˆ° flagã€‚</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">9620154777088870694266521670168986508003314866222315790126552504304846236696183733266828489404860276326158191906907396234236947215466295418632056113826161</span><br>C = matrix(GF(p), [[<span class="hljs-number">7062910478232783138765983170626687981202937184255408287607971780139482616525215270216675887321965798418829038273232695370210503086491228434856538620699645</span>,<span class="hljs-number">7096268905956462643320137667780334763649635657732499491108171622164208662688609295607684620630301031789132814209784948222802930089030287484015336757787801</span>],<br>                  [<span class="hljs-number">7341430053606172329602911405905754386729224669425325419124733847060694853483825396200841609125574923525535532184467150746385826443392039086079562905059808</span>,<span class="hljs-number">2557244298856087555500538499542298526800377681966907502518580724165363620170968463050152602083665991230143669519866828587671059318627542153367879596260872</span>]])<br>[lambda1, lambda2] = C.eigenvalues()<br><span class="hljs-built_in">print</span>(lambda1, lambda2) <br><span class="hljs-built_in">print</span>(<span class="hljs-string">b&#x27;LILCTF&#123;&#x27;</span>+long_to_bytes(<span class="hljs-built_in">int</span>(lambda1)) + long_to_bytes(<span class="hljs-built_in">int</span>(lambda2))+<span class="hljs-string">b&#x27;&#125;&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p><img src="/2026/03/01/LilCTF2025wp/2.png" class=""><h2 id="mid-math">mid_math</h2><p>æœ¬é¢˜å’Œä¸Šè¾¹é¢˜ç›®è¿˜æ˜¯æ¯”è¾ƒç›¸ä¼¼çš„ï¼Œåªæ˜¯å¤šäº†ä¸€æ­¥æ±‚è§£ç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚<br>æ ¹æ®åˆ†æï¼Œå¯ä»¥å‘ç°çŸ©é˜µ C ç›¸ä¼¼äºä¸€ä¸ªå¯¹è§’çŸ©é˜µï¼š<br>$$<br>\begin{bmatrix}<br>a &amp; 0 &amp; 0 &amp; 0 &amp; 0 \newline<br>0 &amp; b &amp; 0 &amp; 0 &amp; 0 \newline<br>0 &amp; 0 &amp; c &amp; 0 &amp; 0 \newline<br>0 &amp; 0 &amp; 0 &amp; d &amp; 0 \newline<br>0 &amp; 0 &amp; 0 &amp; 0 &amp; 0<br>\end{bmatrix}<br>$$<br>å…¶ç‰¹å¾å€¼ä¸º $a,b,c,d,0$ é‚£ä¹ˆç”± $D=C^{key}$â€‹ï¼Œåˆ™ D å¯¹åº”çš„ç‰¹å¾å€¼ä¸ºï¼š<br>$$<br>a^{key},b^{key},c^{key},d^{key},0\mod p<br>$$<br>åœ¨æ±‚å‡ºç‰¹å¾å€¼åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡æ±‚è§£<strong>ç¦»æ•£å¯¹æ•°é—®é¢˜</strong>è·å– keyï¼Œä¹‹åä¾¿å¯ä»¥è·å–flag</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad, pad<br><br>p = <span class="hljs-number">14668080038311483271</span><br>C_list = [[<span class="hljs-number">11315841881544731102</span>, <span class="hljs-number">2283439871732792326</span>, <span class="hljs-number">6800685968958241983</span>, <span class="hljs-number">6426158106328779372</span>, <span class="hljs-number">9681186993951502212</span>],<br>          [<span class="hljs-number">4729583429936371197</span>, <span class="hljs-number">9934441408437898498</span>, <span class="hljs-number">12454838789798706101</span>, <span class="hljs-number">1137624354220162514</span>, <span class="hljs-number">8961427323294527914</span>],<br>          [<span class="hljs-number">12212265161975165517</span>, <span class="hljs-number">8264257544674837561</span>, <span class="hljs-number">10531819068765930248</span>, <span class="hljs-number">4088354401871232602</span>, <span class="hljs-number">14653951889442072670</span>],<br>          [<span class="hljs-number">6045978019175462652</span>, <span class="hljs-number">11202714988272207073</span>, <span class="hljs-number">13562937263226951112</span>, <span class="hljs-number">6648446245634067896</span>, <span class="hljs-number">13902820281072641413</span>],<br>          [<span class="hljs-number">1046075193917103481</span>, <span class="hljs-number">3617988773170202613</span>, <span class="hljs-number">3590111338369894405</span>, <span class="hljs-number">2646640112163975771</span>, <span class="hljs-number">5966864698750134707</span>]]<br>D_list = [[<span class="hljs-number">1785348659555163021</span>, <span class="hljs-number">3612773974290420260</span>, <span class="hljs-number">8587341808081935796</span>, <span class="hljs-number">4393730037042586815</span>, <span class="hljs-number">10490463205723658044</span>],<br>          [<span class="hljs-number">10457678631610076741</span>, <span class="hljs-number">1645527195687648140</span>, <span class="hljs-number">13013316081830726847</span>, <span class="hljs-number">12925223531522879912</span>, <span class="hljs-number">5478687620744215372</span>],<br>          [<span class="hljs-number">9878636900393157276</span>, <span class="hljs-number">13274969755872629366</span>, <span class="hljs-number">3231582918568068174</span>, <span class="hljs-number">7045188483430589163</span>, <span class="hljs-number">5126509884591016427</span>],<br>          [<span class="hljs-number">4914941908205759200</span>, <span class="hljs-number">7480989013464904670</span>, <span class="hljs-number">5860406622199128154</span>, <span class="hljs-number">8016615177615097542</span>, <span class="hljs-number">13266674393818320551</span>],<br>          [<span class="hljs-number">3005316032591310201</span>, <span class="hljs-number">6624508725257625760</span>, <span class="hljs-number">7972954954270186094</span>, <span class="hljs-number">5331046349070112118</span>, <span class="hljs-number">6127026494304272395</span>]]<br>msg = <span class="hljs-string">b&quot;\xcc]B:\xe8\xbc\x91\xe2\x93\xaa\x88\x17\xc4\xe5\x97\x87@\x0fd\xb5p\x81\x1e\x98,Z\xe1n`\xaf\xe0%:\xb7\x8aD\x03\xd2Wu5\xcd\xc4#m&#x27;\xa7\xa4\x80\x0b\xf7\xda8\x1b\x82k#\xc1gP\xbd/\xb5j&quot;</span><br><br>Fp = GF(p)<br>C_mat = matrix(Fp, C_list)<br>D_mat = matrix(Fp, D_list)<br><br><span class="hljs-comment">#è®¡ç®— C å’Œ D çš„ç‰¹å¾å€¼</span><br>eval_C = C_mat.eigenvalues()<br>eval_D = D_mat.eigenvalues()<br><br><span class="hljs-comment">#å»æ‰0ç‰¹å¾å€¼</span><br>eval_C_nonzero = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> eval_C <span class="hljs-keyword">if</span> x != <span class="hljs-number">0</span>]<br>eval_D_nonzero = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> eval_D <span class="hljs-keyword">if</span> x != <span class="hljs-number">0</span>]<br><br><span class="hljs-comment">#è¾“å‡ºç‰¹å¾å€¼</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Nonzero eigenvalues of C:&quot;</span>, eval_C_nonzero)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Nonzero eigenvalues of D:&quot;</span>, eval_D_nonzero)<br><br><span class="hljs-comment">#å°è¯•è®¡ç®—ç¦»æ•£å¯¹æ•°ä»¥æ‰¾åˆ°key</span><br>key = <span class="hljs-literal">None</span><br><span class="hljs-keyword">for</span> mu <span class="hljs-keyword">in</span> eval_D_nonzero:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment">#å°è¯•è®¡ç®—ç¬¬ä¸€ä¸ªéé›¶ç‰¹å¾å€¼å¯¹åº”çš„kå€¼</span><br>        k = discrete_log(mu, eval_C_nonzero[<span class="hljs-number">0</span>])<br>        <span class="hljs-comment">#æ£€æŸ¥kæ˜¯å¦æ»¡è¶³æ¡ä»¶</span><br>        valid = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">for</span> lam <span class="hljs-keyword">in</span> eval_C_nonzero:<br>            <span class="hljs-keyword">if</span> lam^k <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> eval_D_nonzero:<br>                valid = <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> valid:<br>            key = k<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found key: <span class="hljs-subst">&#123;key&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">continue</span><br><br><span class="hljs-keyword">if</span> key <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;Key not found&quot;</span>)<br><br>key_bytes = pad(long_to_bytes(key), <span class="hljs-number">16</span>)<br>aes = AES.new(key_bytes, AES.MODE_ECB)<br>flag = unpad(aes.decrypt(msg), <span class="hljs-number">64</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag:&quot;</span>, flag)<br></code></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p><img src="/2026/03/01/LilCTF2025wp/3.png" class=""><h2 id="Space-Travel">Space Travel</h2><p>ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†åœ¨äºç”Ÿæˆ <code>key</code> å’Œæ³„éœ²ä¿¡æ¯ï¼ˆGiftï¼‰ï¼š</p><ol><li><p><strong>Key çš„ç”Ÿæˆ</strong>:</p><ul><li><code>key</code> æ˜¯ç”± 50 ä¸ªæ¥è‡ª <code>vecs</code> åˆ—è¡¨çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²æ‹¼æ¥è€Œæˆã€‚</li><li>ç´¢å¼•ç”Ÿæˆæ–¹å¼ä¸º <code>urandom(2) &amp; 0xfff</code>ï¼Œè¿™æ„å‘³ç€ç´¢å¼•èŒƒå›´æ˜¯ $0$ åˆ° $4095$ ($2^{12}-1$)ã€‚</li></ul></li><li><p><strong>æ³„éœ²ä¿¡æ¯ (Linear Leakage)</strong>:</p><ul><li><p>é¢˜ç›®è¾“å‡ºäº† 600 ç»„ <code>[nonce, bit]</code>ã€‚</p></li><li><p>è®¡ç®—æ–¹å¼ï¼š<code>bit = (bin(nonce &amp; key).count(&quot;1&quot;)) % 2</code>ã€‚</p></li><li><p>æ•°å­¦æ„ä¹‰ï¼šè¿™æ˜¯ <code>nonce</code> å’Œ <code>key</code> ä¸¤ä¸ªå‘é‡åœ¨ GF(2) æœ‰é™åŸŸä¸Šçš„<strong>å†…ç§¯</strong> (Inner Product)ã€‚</p></li><li><p>è®¾ $K$ ä¸ºå¯†é’¥çš„äºŒè¿›åˆ¶å‘é‡ï¼Œ$N_i$ ä¸ºç¬¬ $i$ ä¸ª nonceï¼Œ$b_i$ ä¸ºç»“æœä½ï¼Œåˆ™æœ‰ï¼š<br>$$<br>N_i \cdot K \equiv b_i \pmod 2<br>$$</p></li></ul></li></ol><p>æˆ‘ä»¬æœ‰ 600 ä¸ªæ–¹ç¨‹ã€‚å¦‚æœ Key æ˜¯å®Œå…¨éšæœºçš„ 800 ä½æ•´æ•°ï¼Œåˆ™æœ‰ 800 ä¸ªå˜é‡ã€‚ä½†è¿™å¹¶ä¸ä»£è¡¨é¢˜ç›®ä¸å¯è§£ã€‚è™½ç„¶æ¯ä¸€ä¸ª bit éƒ½åœ¨å˜ï¼Œä½†å› ä¸º <code>vecs</code> åªæœ‰ 4096 ($2^{12}$) ä¸ªå…ƒç´ ï¼Œè¿™äº› 16 ä½çš„å‘é‡åœ¨æ•°å­¦ä¸Šå¿…ç„¶æ„æˆä¸€ä¸ª <strong>ç»´åº¦ä¸è¶…è¿‡ 12 çš„çº¿æ€§å­ç©ºé—´ï¼ˆæˆ–ä»¿å°„å­ç©ºé—´ï¼‰</strong>ã€‚</p><ol><li><p><strong>é™ç»´åŸç†</strong>ï¼š<br>è™½ç„¶æ¯ä¸ª Block æ˜¯ 16 bitsï¼Œä½†å®ƒä»¬æ˜¯ç”± 12 bits çš„ç´¢å¼•ç”Ÿæˆçš„ã€‚å¦‚æœ <code>vecs</code> æ˜¯çº¿æ€§ç”Ÿæˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ° <strong>12 ä¸ªåŸºå‘é‡ (Basis Vectors)</strong> æ¥è¡¨ç¤ºæ‰€æœ‰çš„ <code>vecs</code> å…ƒç´ ã€‚<br>$$<br>Vec = C + k_0 \cdot B_0 + k_1 \cdot B_1 + â€¦ + k_{11} \cdot B_{11}<br>$$</p><ul><li>$C$: åç§»å‘é‡ (Offset/Base vector)ï¼Œé€šå¸¸å– <code>vecs[0]</code>ã€‚</li><li>$B_i$: åŸºå‘é‡ã€‚</li><li>$k_i$: ç³»æ•° (0 æˆ– 1)ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦è§£çš„<strong>æ–°å˜é‡</strong>ã€‚</li></ul></li><li><p><strong>å˜é‡ç»Ÿè®¡</strong>ï¼š</p><ul><li>æ–°å˜é‡ï¼š50 ä¸ª Block $\times$ 12 ä¸ªç³»æ•° = 600 ä¸ªå˜é‡ã€‚</li><li>æ–¹ç¨‹æ•°ï¼š600 ä¸ªã€‚</li><li><strong>600 = 600ï¼Œæ­¤æ—¶æ»¡ç§©å¯è§£</strong></li></ul></li></ol><p>å…·ä½“è§£é¢˜ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ast<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-comment"># ================= 1. åˆ†æ Vecs çš„çº¿æ€§ç»“æ„ =================</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Analyzing the linear structure of vecs...&quot;</span>)<br><br><span class="hljs-comment"># å°† vecs (å­—ç¬¦ä¸²åˆ—è¡¨) è½¬æ¢ä¸º GF(2) çŸ©é˜µ</span><br><span class="hljs-comment"># vecs å…ƒç´ å¦‚ &#x27;0111...&#x27;</span><br>vecs_matrix = Matrix(GF(<span class="hljs-number">2</span>), [[<span class="hljs-built_in">int</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s] <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> vecs])<br><br><span class="hljs-comment"># å–ç¬¬ä¸€ä¸ªå‘é‡ä½œä¸ºåŸºå‡†åç§»é‡ (Base Vector)</span><br>base_vec = vecs_matrix[<span class="hljs-number">0</span>]<br><br><span class="hljs-comment"># è®¡ç®—å·®åˆ†çŸ©é˜µ: &#123;v - v0&#125;</span><br>diff_vecs = [row - base_vec <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> vecs_matrix]<br>diff_matrix = Matrix(GF(<span class="hljs-number">2</span>), diff_vecs)<br><br><span class="hljs-comment"># è®¡ç®—çº¿æ€§åŸº (Basis)</span><br>basis = diff_matrix.row_space()<br>basis_vectors = basis.basis()<br><br>DIM = <span class="hljs-built_in">len</span>(basis_vectors)<br>BLOCK_LEN = vecs_matrix.ncols() <span class="hljs-comment"># åº”è¯¥æ˜¯ 16</span><br>NUM_BLOCKS = <span class="hljs-number">50</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Block Length: <span class="hljs-subst">&#123;BLOCK_LEN&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Subspace Dimension: <span class="hljs-subst">&#123;DIM&#125;</span>&quot;</span>) <span class="hljs-comment"># é¢„æœŸæ˜¯ 12</span><br><br><span class="hljs-comment"># ================= 2. æ„å»ºçº¿æ€§æ–¹ç¨‹ç»„ =================</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Building linear system...&quot;</span>)<br><br><span class="hljs-comment"># è¯»å– output.txt</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    content = f.read()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;ğŸ :&quot;</span> <span class="hljs-keyword">in</span> content:<br>        list_str = content.split(<span class="hljs-string">&quot;ğŸ :&quot;</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">&quot;\n&quot;</span>)[<span class="hljs-number">0</span>].strip()<br>    <span class="hljs-keyword">else</span>:<br>        list_str = content.strip()<br>    data = ast.literal_eval(list_str)<br><br>M = []<br>B = []<br><br><span class="hljs-keyword">for</span> nonce_int, target_bit <span class="hljs-keyword">in</span> data:<br>    row = []<br>    <br>    <span class="hljs-comment"># rhs_val ç”¨äºå­˜å‚¨æ–¹ç¨‹å³è¾¹çš„å€¼ (target - å¸¸æ•°é¡¹)</span><br>    rhs_val = <span class="hljs-built_in">int</span>(target_bit)<br>    <br>    <span class="hljs-comment"># éå† 50 ä¸ª block</span><br>    <span class="hljs-keyword">for</span> block_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(NUM_BLOCKS):<br>        <span class="hljs-comment"># æå–å½“å‰ block å¯¹åº”çš„ Nonce ç‰‡æ®µ (16 bits)</span><br>        <span class="hljs-comment"># ç§»ä½é€»è¾‘ï¼šBlock 0 æ˜¯æœ€é«˜ä½</span><br>        shift_amount = (NUM_BLOCKS - <span class="hljs-number">1</span> - block_idx) * BLOCK_LEN<br>        nonce_chunk = (nonce_int &gt;&gt; shift_amount) &amp; ((<span class="hljs-number">1</span> &lt;&lt; BLOCK_LEN) - <span class="hljs-number">1</span>)<br>        <br>        <span class="hljs-comment"># å°† nonce_chunk è½¬ä¸º Sage å‘é‡</span><br>        <span class="hljs-comment"># æ³¨æ„ä½åºï¼šå­—ç¬¦ä¸² index 0 æ˜¯æœ€é«˜ä½</span><br>        nonce_vec = vector(GF(<span class="hljs-number">2</span>), [(nonce_chunk &gt;&gt; (BLOCK_LEN - <span class="hljs-number">1</span> - i)) &amp; <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BLOCK_LEN)])<br>        <br>        <span class="hljs-comment"># 1. è®¡ç®—å¸¸æ•°éƒ¨åˆ†çš„è´¡çŒ® (Offset Contribution)</span><br>        <span class="hljs-comment"># dot_product ç»“æœæ˜¯ GF(2) å…ƒç´ ï¼Œå¿…é¡»è½¬ä¸º int</span><br>        const_contribution = <span class="hljs-built_in">int</span>(nonce_vec * base_vec)<br>        <br>        <span class="hljs-comment"># æ›´æ–° RHS: å‡å»å¸¸æ•°é¡¹ (åœ¨ GF(2) ä¸­å‡æ³•ç­‰äºåŠ æ³•)</span><br>        rhs_val = (rhs_val + const_contribution) % <span class="hljs-number">2</span><br>        <br>        <span class="hljs-comment"># 2. è®¡ç®—å˜é‡ç³»æ•° (Coefficients of Basis)</span><br>        <span class="hljs-keyword">for</span> basis_vec <span class="hljs-keyword">in</span> basis_vectors:<br>            <span class="hljs-comment"># è®¡ç®— nonce å¯¹è¯¥åŸºå‘é‡çš„æŠ•å½±</span><br>            coeff = <span class="hljs-built_in">int</span>(nonce_vec * basis_vec)<br>            row.append(coeff)<br>            <br>    M.append(row)<br>    B.append(rhs_val)<br><br><span class="hljs-comment"># ================= 3. æ±‚è§£ =================</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Solving with SageMath...&quot;</span>)<br>MS = Matrix(GF(<span class="hljs-number">2</span>), M)<br>VS = vector(GF(<span class="hljs-number">2</span>), B)<br><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-comment"># solve_right æ±‚è§£ M * x = B</span><br>    coeffs = MS.solve_right(VS)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Solution found!&quot;</span>)<br>    <br>    <span class="hljs-comment"># ================= 4. é‡ç»„ Key =================</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Reconstructing Key...&quot;</span>)<br>    <br>    full_key_bits = <span class="hljs-string">&quot;&quot;</span><br>    <br>    <span class="hljs-comment"># éå† 50 ä¸ª Blockï¼Œåˆ©ç”¨è§£å‡ºçš„ç³»æ•°é‡å»ºæ¯ä¸ª Block</span><br>    <span class="hljs-keyword">for</span> block_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(NUM_BLOCKS):<br>        <span class="hljs-comment"># å–å‡ºå½“å‰ Block å¯¹åº”çš„ DIM (12) ä¸ªç³»æ•°</span><br>        block_coeffs = coeffs[block_idx*DIM : (block_idx+<span class="hljs-number">1</span>)*DIM]<br>        <br>        <span class="hljs-comment"># é‡å»ºå‘é‡: V = Base + Sum(c_i * B_i)</span><br>        recovered_vec = base_vec<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(DIM):<br>            <span class="hljs-keyword">if</span> block_coeffs[i] == <span class="hljs-number">1</span>:<br>                recovered_vec += basis_vectors[i]<br>        <br>        <span class="hljs-comment"># å°†å‘é‡è½¬å› &#x27;01&#x27; å­—ç¬¦ä¸²</span><br>        vec_str = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> recovered_vec)<br>        full_key_bits += vec_str<br>        <br>    key_int = <span class="hljs-built_in">int</span>(full_key_bits, <span class="hljs-number">2</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Recovered Key: <span class="hljs-subst">&#123;key_int&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># ================= 5. è§£å¯† Flag =================</span><br>    aes_key = md5(<span class="hljs-built_in">str</span>(key_int).encode()).digest()<br><br>    ciphertext = <span class="hljs-string">b&#x27;r\x9f\xa5N\x19\xa3\x8b-\xfen\xa7\xc9\xca\x87\x04\x873#ju\xc5\x06\xd0\x85L\x1ab\xa1XEre\xe5\x8c:h&#x27;</span><br>    cipher = AES.new(key=aes_key, nonce=<span class="hljs-string">b&quot;Tiffany&quot;</span>, mode=AES.MODE_CTR)<br>    flag = cipher.decrypt(ciphertext)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ğŸš© FLAG: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">except</span> ValueError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] No solution found. System might be inconsistent.&quot;</span>)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] An error occurred during reconstruction/decryption: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p><img src="/2026/03/01/LilCTF2025wp/4.png" class=""><h2 id="Linear">Linear</h2><p>æ„é€ æ ¼æ±‚è§£ï¼Œå…·ä½“çš„æ„é€ å†™åœ¨è„šæœ¬æ³¨é‡Šä¸­äº†ã€‚å¥½å§ï¼Œå…¶å®æ˜¯æˆ‘ä¸ä¼šï¼ˆï¼‰ï¼ŒGemini ç‹æœäº†ã€‚</p><p>æ±‚è§£ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> ast<br><br>HOST,PORT = <span class="hljs-string">&quot;challenge.imxbt.cn&quot;</span> , <span class="hljs-number">31501</span><br>io = remote(HOST, PORT)<br><br><span class="hljs-comment"># æ¥æ”¶ A (æ ¼å¼: [[...]])</span><br>io.recvuntil(<span class="hljs-string">b&quot;[[&quot;</span>)<br>raw_A_str = <span class="hljs-string">&quot;[[&quot;</span> + io.recvuntil(<span class="hljs-string">b&quot;]]&quot;</span>).decode()<br>A_list = ast.literal_eval(raw_A_str)<br><span class="hljs-comment"># æ¥æ”¶ b (æ ¼å¼: [...])</span><br>io.recvuntil(<span class="hljs-string">b&quot;[&quot;</span>)<br>raw_b_str = <span class="hljs-string">&quot;[&quot;</span> + io.recvuntil(<span class="hljs-string">b&quot;]&quot;</span>).decode()<br>b_list = ast.literal_eval(raw_b_str)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_sis</span>():<br><br>    <span class="hljs-comment"># å®šä¹‰çŸ©é˜µå’Œå‘é‡</span><br>    <span class="hljs-comment"># è¿™é‡Œä½¿ç”¨ ZZ (æ•´æ•°ç¯)</span><br>    A = Matrix(ZZ, A_list)<br>    b = vector(ZZ, b_list)<br>    <br>    nrows = A.nrows()   <span class="hljs-comment"># 16</span><br>    ncols = A.ncols()   <span class="hljs-comment"># 32</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] æ­£åœ¨åˆå§‹åŒ–æ ¼çŸ©é˜µ (Rows: <span class="hljs-subst">&#123;nrows&#125;</span>, Cols: <span class="hljs-subst">&#123;ncols&#125;</span>)...&quot;</span>)<br><br>    <span class="hljs-comment"># -----------------------------------------------------</span><br>    <span class="hljs-comment"># æ„é€ æ ¼ (Lattice Construction) - Embedding Method</span><br>    <span class="hljs-comment"># -----------------------------------------------------</span><br>    <span class="hljs-comment"># æˆ‘ä»¬æ„é€ ä¸€ä¸ªçŸ©é˜µ Mï¼Œå½¢å¼å¦‚ä¸‹ï¼š</span><br>    <span class="hljs-comment"># [ I  |  K * A^T ]</span><br>    <span class="hljs-comment"># [ 0  | -K * b^T ]</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># è¿™é‡Œçš„ K æ˜¯ä¸€ä¸ªå·¨å¤§çš„æƒé‡ã€‚</span><br>    <span class="hljs-comment"># å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå‘é‡ v = (x_1, ..., x_32, 1)</span><br>    <span class="hljs-comment"># v * M = (x, K(Ax - b))</span><br>    <span class="hljs-comment"># å¦‚æœ Ax = bï¼Œé‚£ä¹ˆç»“æœå‘é‡çš„å³åŠéƒ¨åˆ†å°†å…¨éƒ¨ä¸º 0ã€‚</span><br>    <span class="hljs-comment"># LLL ç®—æ³•ä¼šå¯»æ‰¾çŸ­å‘é‡ï¼Œå› ä¸º x å¾ˆå°è€Œ K å¾ˆå¤§ï¼Œç®—æ³•ä¼šä¼˜å…ˆå¼ºåˆ¶å³åŠéƒ¨åˆ†ä¸º 0ã€‚</span><br>    <span class="hljs-comment"># -----------------------------------------------------</span><br><br>    <span class="hljs-comment"># æƒé‡ Kï¼šå¿…é¡»è¶³å¤Ÿå¤§ï¼Œä½¿å¾—æ»¡è¶³æ–¹ç¨‹çº¦æŸæ¯”å‡å° x çš„æ•°å€¼æ›´é‡è¦ã€‚</span><br>    <span class="hljs-comment"># x çš„æœ€å¤§å€¼çº¦ 10^5ï¼ŒK å– 10^10 ä»¥ä¸Šæ¯”è¾ƒå®‰å…¨ã€‚</span><br>    K = <span class="hljs-number">2</span>**<span class="hljs-number">60</span> <br>    <br>    <span class="hljs-comment"># æ„é€ çŸ©é˜µ M</span><br>    <span class="hljs-comment"># ç»´åº¦ï¼š(32ä¸ªå˜é‡ + 1ä¸ªå¸¸æ•°é¡¹) è¡Œï¼Œ (32åˆ—å­˜x + 16åˆ—å­˜çº¦æŸ) åˆ—</span><br>    M = Matrix(ZZ, ncols + <span class="hljs-number">1</span>, ncols + nrows)<br>    <br>    <span class="hljs-comment"># 1. å·¦ä¸Šè§’ï¼šå•ä½çŸ©é˜µ I (ç”¨äºä¿æŒ x çš„å€¼)</span><br>    M.set_block(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, Matrix.identity(ncols))<br>    <br>    <span class="hljs-comment"># 2. å³ä¸Šè§’ï¼šK * A^T (æ–¹ç¨‹ç³»æ•°)</span><br>    M.set_block(<span class="hljs-number">0</span>, ncols, K * A.transpose())<br>    <br>    <span class="hljs-comment"># 3. æœ€åä¸€è¡Œï¼šå¸¸æ•°é¡¹å¤„ç†</span><br>    <span class="hljs-comment"># å·¦ä¸‹è§’æ˜¯ 0 (é»˜è®¤å°±æ˜¯0ï¼Œä¸ç”¨è®¾)</span><br>    <span class="hljs-comment"># å³ä¸‹è§’æ˜¯ -K * b (æ–¹ç¨‹çš„å¸¸æ•°é¡¹ç§»é¡¹)</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows):<br>        M[ncols, ncols + i] = -K * b[i]<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] æ­£åœ¨è¿è¡Œ LLL ç®—æ³• (è¿™å¯èƒ½éœ€è¦å‡ ç§’é’Ÿ)...&quot;</span>)<br>    <br>    <span class="hljs-comment"># è¿è¡Œ LLL è§„çº¦</span><br>    L_reduced = M.LLL()<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] LLL å®Œæˆï¼Œæ­£åœ¨æœç´¢è§£å‘é‡...&quot;</span>)<br><br>    solution = <span class="hljs-literal">None</span><br>    <br>    <span class="hljs-comment"># éå†è§„çº¦ååŸºåº•çš„æ¯ä¸€è¡Œ</span><br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> L_reduced:<br>        <span class="hljs-comment"># æå–å‘é‡çš„å³åŠéƒ¨åˆ† (åº”è¯¥å…¨ä¸º 0)</span><br>        check_part = row[ncols:]<br>        <br>        <span class="hljs-comment"># æå–å‘é‡çš„å·¦åŠéƒ¨åˆ† (å¯èƒ½æ˜¯è§£ x)</span><br>        x_part = row[:ncols]<br>        <br>        <span class="hljs-comment"># æ£€æŸ¥1ï¼šçº¦æŸéƒ¨åˆ†æ˜¯å¦å…¨ä¸º 0</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> check_part.is_zero():<br>            <span class="hljs-keyword">continue</span><br>            <br>        <span class="hljs-comment"># æ£€æŸ¥2ï¼šx éƒ¨åˆ†ä¸èƒ½å…¨ä¸º 0</span><br>        <span class="hljs-keyword">if</span> x_part.is_zero():<br>            <span class="hljs-keyword">continue</span><br>            <br>        <span class="hljs-comment"># ä¿®æ­£ç¬¦å·ï¼šLLL å¯èƒ½ä¼šè¿”å› -x</span><br>        <span class="hljs-comment"># é¢˜ç›®ä¸­ x æ˜¯æ­£æ•´æ•°ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å‘ç°å¤§éƒ¨åˆ†æ˜¯è´Ÿæ•°ï¼Œå°±å–å</span><br>        <span class="hljs-comment"># ç®€å•çš„å¯å‘å¼ï¼šçœ‹ç¬¬ä¸€ä¸ªéé›¶å…ƒç´ æ˜¯å¦ä¸ºè´Ÿ</span><br>        <span class="hljs-keyword">if</span> x_part[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">0</span>:<br>            x_part = -x_part<br>            <br>        <span class="hljs-comment"># æ£€æŸ¥3ï¼šä»£å›éªŒè¯ Ax = b</span><br>        <span class="hljs-comment"># å°† vector è½¬æ¢ä¸º list æ–¹ä¾¿è®¡ç®—</span><br>        x_candidate = <span class="hljs-built_in">list</span>(x_part)<br>        <br>        <span class="hljs-comment"># éªŒè¯</span><br>        recalc_b = [<span class="hljs-built_in">sum</span>(A_list[i][j] * x_candidate[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ncols)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nrows)]<br>        <br>        <span class="hljs-keyword">if</span> recalc_b == b_list:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] æˆåŠŸæ‰¾åˆ°è§£ï¼&quot;</span>)<br>            solution = x_candidate<br>            <span class="hljs-keyword">break</span><br>    <br>    <span class="hljs-keyword">if</span> solution:<br>        x = <span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, solution))<br>        <span class="hljs-built_in">print</span>(x)<br>        io.sendlineafter(<span class="hljs-string">b&quot;Enter your solution: &quot;</span>, x.encode())<br>        <span class="hljs-built_in">print</span>(io.recvall().decode())<br>        io.close()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] æœªæ‰¾åˆ°è§£ã€‚å¯èƒ½åŸå› ï¼š&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;2. æƒé‡ K ä¸å¤Ÿå¤§ (å°è¯•å¢å¤§ K)&quot;</span>)<br><br><span class="hljs-comment"># æ‰§è¡Œ</span><br>solve_sis()<br></code></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p><img src="/2026/03/01/LilCTF2025wp/5.png" class=""><h2 id="baaaaag">baaaaag</h2><p>å¯ä»¥å‘ç°æ˜¯éå¸¸åŸå§‹çš„èƒŒåŒ…åŠ å¯†ç³»ç»Ÿï¼Œç›´æ¥é€ æ ¼æ‰“ LLL ä¼šå‘ç°å‡ºä¸äº†ç»“æœï¼Œä½†æ˜¯ä½¿ç”¨æ›´å¼ºçš„ BKZï¼Œç„¶å block_size è®¾ç½®çš„ç¨å¾®å¤§ä¸€ç‚¹å°±èƒ½å‡ºã€‚</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-comment"># ==========================================</span><br><span class="hljs-comment"># é¢˜ç›®æ•°æ®</span><br><span class="hljs-comment"># ==========================================</span><br>a = [<span class="hljs-number">965032030645819473226880279</span>, <span class="hljs-number">699680391768891665598556373</span>, <span class="hljs-number">1022177754214744901247677527</span>, <span class="hljs-number">680767714574395595448529297</span>, <span class="hljs-number">1051144590442830830160656147</span>, <span class="hljs-number">1168660688736302219798380151</span>, <span class="hljs-number">796387349856554292443995049</span>, <span class="hljs-number">740579849809188939723024937</span>, <span class="hljs-number">940772121362440582976978071</span>, <span class="hljs-number">787438752754751885229607747</span>, <span class="hljs-number">1057710371763143522769262019</span>, <span class="hljs-number">792170184324681833710987771</span>, <span class="hljs-number">912844392679297386754386581</span>, <span class="hljs-number">906787506373115208506221831</span>, <span class="hljs-number">1073356067972226734803331711</span>, <span class="hljs-number">1230248891920689478236428803</span>, <span class="hljs-number">713426848479513005774497331</span>, <span class="hljs-number">979527247256538239116435051</span>, <span class="hljs-number">979496765566798546828265437</span>, <span class="hljs-number">836939515442243300252499479</span>, <span class="hljs-number">1185281999050646451167583269</span>, <span class="hljs-number">673490198827213717568519179</span>, <span class="hljs-number">776378201435505605316348517</span>, <span class="hljs-number">809920773352200236442451667</span>, <span class="hljs-number">1032450692535471534282750757</span>, <span class="hljs-number">1116346000400545215913754039</span>, <span class="hljs-number">1147788846283552769049123803</span>, <span class="hljs-number">994439464049503065517009393</span>, <span class="hljs-number">825645323767262265006257537</span>, <span class="hljs-number">1076742721724413264636318241</span>, <span class="hljs-number">731782018659142904179016783</span>, <span class="hljs-number">656162889354758353371699131</span>, <span class="hljs-number">1045520414263498704019552571</span>, <span class="hljs-number">1213714972395170583781976983</span>, <span class="hljs-number">949950729999198576080781001</span>, <span class="hljs-number">1150032993579134750099465519</span>, <span class="hljs-number">975992662970919388672800773</span>, <span class="hljs-number">1129148699796142943831843099</span>, <span class="hljs-number">898871798141537568624106939</span>, <span class="hljs-number">997718314505250470787513281</span>, <span class="hljs-number">631543452089232890507925619</span>, <span class="hljs-number">831335899173370929279633943</span>, <span class="hljs-number">1186748765521175593031174791</span>, <span class="hljs-number">884252194903912680865071301</span>, <span class="hljs-number">1016020417916761281986717467</span>, <span class="hljs-number">896205582917201847609656147</span>, <span class="hljs-number">959440423632738884107086307</span>, <span class="hljs-number">993368100536690520995612807</span>, <span class="hljs-number">702602277993849887546504851</span>, <span class="hljs-number">1102807438605649402749034481</span>, <span class="hljs-number">629539427333081638691538089</span>, <span class="hljs-number">887663258680338594196147387</span>, <span class="hljs-number">1001965883259152684661493409</span>, <span class="hljs-number">1043811683483962480162133633</span>, <span class="hljs-number">938713759383186904819771339</span>, <span class="hljs-number">1023699641268310599371568653</span>, <span class="hljs-number">784025822858960757703945309</span>, <span class="hljs-number">986182634512707587971047731</span>, <span class="hljs-number">1064739425741411525721437119</span>, <span class="hljs-number">1209428051066908071290286953</span>, <span class="hljs-number">667510673843333963641751177</span>, <span class="hljs-number">642828919542760339851273551</span>, <span class="hljs-number">1086628537309368288204342599</span>, <span class="hljs-number">1084848944960506663668298859</span>, <span class="hljs-number">667827295200373631038775959</span>, <span class="hljs-number">752634137348312783761723507</span>, <span class="hljs-number">707994297795744761368888949</span>, <span class="hljs-number">747998982630688589828284363</span>, <span class="hljs-number">710184791175333909291593189</span>, <span class="hljs-number">651183930154725716807946709</span>, <span class="hljs-number">724836607223400074343868079</span>, <span class="hljs-number">1118993538091590299721647899</span>]<br>b = <span class="hljs-number">34962396275078207988771864327</span><br>ciphertext = <span class="hljs-string">b&#x27;Lo~G\xf46&gt;\xd609\x8e\x8e\xf5\xf83\xb5\xf0\x8f\x9f6&amp;\xea\x02\xfa\xb1_L\x85\x93\x93\xf7,`|\xc6\xbe\x05&amp;\x85\x8bC\xcd\xe6?TV4q&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    n = <span class="hljs-built_in">len</span>(a)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] Problem dimension: n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-comment"># ä½¿ç”¨æå…¶å·¨å¤§çš„æƒé‡ Kï¼Œå½»åº•æ¶ˆé™¤éƒ¨åˆ†å’Œçš„å±€éƒ¨æå°å€¼å¹²æ‰°</span><br>    K = <span class="hljs-number">2</span>**<span class="hljs-number">200</span> <br>    <br>    <span class="hljs-comment"># æ„é€ ç²¾ç¡®çš„ (n+1) x (n+1) çŸ©é˜µ</span><br>    M = Matrix(ZZ, n + <span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>)<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[i, i] = <span class="hljs-number">2</span>          <span class="hljs-comment"># å¯¹è§’çº¿ä¸º 2</span><br>        M[i, n] = K * a[i]   <span class="hljs-comment"># æœ€åä¸€åˆ—ä¹˜ä»¥å·¨å¤§æƒé‡ K</span><br>        <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        M[n, i] = <span class="hljs-number">1</span>          <span class="hljs-comment"># æœ€åä¸€è¡Œå‰ n åˆ—ä¸º 1</span><br>    M[n, n] = K * b          <span class="hljs-comment"># å³ä¸‹è§’ä¸º K * b</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Reconstructed highly weighted CJLOSS lattice.&quot;</span>)<br>    <br>    <span class="hljs-comment"># æ£€æŸ¥çŸ©é˜µå¹¶æå– p çš„å‡½æ•°</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">check_matrix</span>(<span class="hljs-params">B_mat</span>):<br>        <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> B_mat:<br>            <span class="hljs-comment"># ä¸¥æ ¼æ£€æŸ¥æœ€åä¸€åˆ—æ˜¯å¦ä¸º0ï¼ˆç”±äºæƒé‡Kæå¤§ï¼Œè¿™é‡Œä¸º0æ„å‘³ç€100%æ»¡è¶³èƒŒåŒ…å’Œï¼‰</span><br>            <span class="hljs-keyword">if</span> row[n] != <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">continue</span><br>                <br>            vec = row[:n]<br>            <span class="hljs-comment"># æ£€æŸ¥å‰né¡¹æ˜¯å¦å…¨ä¸º 1 æˆ– -1</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">all</span>(<span class="hljs-built_in">abs</span>(v) == <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> vec):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Found short vector (1/-1): <span class="hljs-subst">&#123;vec[:<span class="hljs-number">10</span>]&#125;</span>...&quot;</span>)<br>                <br>                <span class="hljs-comment"># æ ¼åŸºè§„çº¦å¯èƒ½æ‰¾åˆ°ç›®æ ‡å‘é‡ï¼Œä¹Ÿå¯èƒ½æ‰¾åˆ°å®ƒçš„ç›¸åæ•° (-vec)</span><br>                <span class="hljs-comment"># å› æ­¤æˆ‘ä»¬ç”Ÿæˆä¸¤ç§æƒ…å†µè¿›è¡Œæµ‹è¯•</span><br>                x_candidates = [<br>                    [(v + <span class="hljs-number">1</span>) // <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> vec],<br>                    [(-v + <span class="hljs-number">1</span>) // <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> vec]<br>                ]<br>                <br>                <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> x_candidates:<br>                    calc_sum = <span class="hljs-built_in">sum</span>(x[i] * a[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n))<br>                    <span class="hljs-keyword">if</span> calc_sum == b:<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Subset sum verified successfully!&quot;</span>)<br>                        <br>                        <span class="hljs-comment"># è¿˜åŸ p</span><br>                        p = <span class="hljs-number">0</span><br>                        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>                            p += <span class="hljs-built_in">int</span>(x[i]) * (<span class="hljs-number">1</span> &lt;&lt; i)<br>                            <br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] Recovered p: <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br>                        <br>                        <span class="hljs-comment"># è§£å¯†</span><br>                        key = hashlib.sha256(<span class="hljs-built_in">str</span>(p).encode()).digest()<br>                        cipher = AES.new(key, AES.MODE_ECB)<br>                        <span class="hljs-keyword">try</span>:<br>                            pt = cipher.decrypt(ciphertext)<br>                            flag = unpad(pt, <span class="hljs-number">16</span>).decode()<br>                            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[SUCCESS] FLAG: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>                            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>                        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] Padding error during decryption: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    block_size  = <span class="hljs-number">30</span><br>    B_bkz = M.BKZ(block_size=block_size)<br>    <span class="hljs-keyword">if</span> check_matrix(B_bkz):<br>        <span class="hljs-keyword">return</span><br>            <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[-] All lattice reduction techniques failed. Please check the inputs.&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    solve()<br></code></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p><img src="/2026/03/01/LilCTF2025wp/6.png" class=""><p>è¯¦ç»†çš„é¢˜ç›®æ–‡ä»¶ä¸è§£é¢˜è„šæœ¬ä»¥åŠ <strong>WriteUp</strong> çš„ pdf å¯ä»¥é€šè¿‡å…³äºé¡µä¸­æˆ‘çš„ GitHub ä»“åº“æ‰¾åˆ°ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>åšé¢˜å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0xFunCTF2026wp</title>
    <link href="/2026/02/27/0xFunCTF2026wp/"/>
    <url>/2026/02/27/0xFunCTF2026wp/</url>
    
    <content type="html"><![CDATA[<h2 id="Welcome">Welcome</h2><p>æ‰“å¼€å®˜æ–¹çš„discordæœåŠ¡å™¨ï¼Œç¨åŠ æŸ¥çœ‹åå³å¯å¾—åˆ°flagã€‚</p><img src="/2026/02/27/0xFunCTF2026wp/1.png" class=""><h2 id="Leonine-Misbegotten">Leonine Misbegotten</h2><p>ç†è§£é¢˜ç›®æ„æ€åå°±å¾ˆå¥½åšäº†ï¼Œæ¯è½®æ“ä½œå¯¹å½“å‰çŠ¶æ€éšæœºé€‰å–ä¸€ç§ç¼–ç æ–¹å¼åŠ å¯†ï¼Œä»è€Œå¾—åˆ°ä¸‹ä¸€çŠ¶æ€çš„ä¸€éƒ¨åˆ†ï¼Œå†å¯¹å½“å‰çŠ¶æ€æ±‚ <strong>sha1</strong> ä½œä¸ºä¸‹ä¸€çŠ¶æ€çš„å¦ä¸€éƒ¨åˆ†ï¼Œæ‹¼æ¥å¾—åˆ°ä¸‹ä¸€çŠ¶æ€ã€‚</p><p>$$<br>s_{n+1} = f(s_n) + sha1(s_n)<br>$$</p><p>å› ä¸º <strong>sha1</strong> å¾—åˆ°çš„å­—èŠ‚æ•°ä¸ºå›ºå®šçš„ï¼Œæ‰€ä»¥å¯ä»¥æå–æœ€åçš„20å­—èŠ‚ï¼Œéå†å››ç§ç¼–ç æ–¹å¼æ±‚è§£åŸç ï¼Œå†å°†å…¶ <strong>sha1</strong> å€¼è¿›è¡Œæ¯”å¯¹æ ¡éªŒï¼Œ16æ¬¡å¾ªç¯å¤„ç†åå³å¯å¾—åˆ°ç»“æœã€‚</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b16decode, b32decode, b64decode, b85decode<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha1<br><br><span class="hljs-comment"># å®šä¹‰è§£ç å‡½æ•°åˆ—è¡¨</span><br>DECODERS = [b16decode, b32decode, b64decode, b85decode]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    <span class="hljs-comment"># 1. è¯»å– output æ–‡ä»¶å†…å®¹</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        current = f.read()<br><br>    rounds = <span class="hljs-number">16</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>        <span class="hljs-comment"># 2. æå–æœ€å 20 å­—èŠ‚çš„æ ¡éªŒå’Œ</span><br>        checksum = current[-<span class="hljs-number">20</span>:]<br>        <span class="hljs-comment"># 3. æå–å‰é¢çš„ç¼–ç æ•°æ®</span><br>        payload = current[:-<span class="hljs-number">20</span>]<br>        <br>        found = <span class="hljs-literal">False</span><br>        <span class="hljs-comment"># 4. å°è¯•å››ç§è§£ç æ–¹å¼</span><br>        <span class="hljs-keyword">for</span> decode_func <span class="hljs-keyword">in</span> DECODERS:<br>            <span class="hljs-keyword">try</span>:<br>                decoded = decode_func(payload)<br>                <span class="hljs-comment"># 5. æ ¡éªŒ SHA1 æ˜¯å¦åŒ¹é…</span><br>                <span class="hljs-keyword">if</span> sha1(decoded).digest() == checksum:<br>                    current = decoded<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ç¬¬ <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span> è½®è§£å¯†æˆåŠŸ: ä½¿ç”¨äº† <span class="hljs-subst">&#123;decode_func.__name__&#125;</span>&quot;</span>)<br>                    found = <span class="hljs-literal">True</span><br>                    <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">except</span> Exception:<br>                <span class="hljs-comment"># å¦‚æœè§£ç å¤±è´¥ï¼ˆæ¯”å¦‚å­—ç¬¦ä¸ç¬¦åˆè§„èŒƒï¼‰ï¼Œå°è¯•ä¸‹ä¸€ç§</span><br>                <span class="hljs-keyword">continue</span><br>        <br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é”™è¯¯ï¼šåœ¨ç¬¬ <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span> è½®æœªèƒ½åŒ¹é…åˆ°æ­£ç¡®çš„è§£ç æ–¹å¼ã€‚&quot;</span>)<br>            <span class="hljs-keyword">break</span><br>    <br>    <span class="hljs-comment"># è¾“å‡ºç»“æœ</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\næœ€ç»ˆç»“æœ (Flag):&quot;</span>)<br>    <span class="hljs-built_in">print</span>(current.decode(errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    solve()<br></code></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p><img src="/2026/02/27/0xFunCTF2026wp/6.png" class=""><h2 id="The-Slot-Whisperer">The Slot Whisperer</h2><p>æ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªçº¿æ€§åŒä½™ç”Ÿæˆå™¨ç›¸å…³çš„é—®é¢˜ï¼Œç”Ÿæˆè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>$$<br>s_{n+1} = as_n+c \mod m<br>$$</p><p>å…¶ä¸­$a,c,m$æˆ‘ä»¬å…¨éƒ¨å·²çŸ¥ï¼Œseedçš„å€¼ä¸çŸ¥é“ï¼Œæˆ‘ä»¬æ ¹æ®è¾“å‡ºå¯ä»¥çŸ¥é“ç”Ÿæˆçš„å‰åä¸ªæ•°å­—ã€‚è¿›è€Œæˆ‘ä»¬çŸ¥é“ï¼š</p><p>$$<br>s_i=n_i+100k\quad k\in \mathbb{Z}<br>$$</p><p>åˆå› ä¸ºæ¯æ¬¡çš„stateæ˜¯æ¨¡äº†måçš„ç»“æœï¼Œæ‰€ä»¥å¿…ç„¶å°äºmï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥çˆ†ç ´$k$çš„å€¼ä»è€Œæ¢å¤LCGçš„åˆå§‹çŠ¶æ€ã€‚</p><p>PSï¼šå› ä¸º$m=2147483647$ï¼Œè€Œå¾ªç¯æ­¥é•¿ä¸º100ï¼Œæ‰€ä»¥åªéœ€è¦2100ä¸‡æ¬¡å·¦å³çš„å¾ªç¯å³å¯ï¼Œè¿™æ˜¯å¾ˆå¿«çš„ã€‚</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    <span class="hljs-comment"># é¢˜ç›®ç»™å‡ºçš„å·²çŸ¥åºåˆ—</span><br>    targets = [<span class="hljs-number">71</span>, <span class="hljs-number">6</span>, <span class="hljs-number">79</span>, <span class="hljs-number">39</span>, <span class="hljs-number">94</span>, <span class="hljs-number">28</span>, <span class="hljs-number">98</span>, <span class="hljs-number">72</span>, <span class="hljs-number">1</span>, <span class="hljs-number">76</span>]<br>    <br>    <span class="hljs-comment"># LCG å‚æ•°</span><br>    M = <span class="hljs-number">2147483647</span><br>    A = <span class="hljs-number">48271</span><br>    C = <span class="hljs-number">12345</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] æ­£åœ¨çˆ†ç ´åˆå§‹çŠ¶æ€ï¼Œæ­£åœ¨éªŒè¯å®Œæ•´åºåˆ—: <span class="hljs-subst">&#123;targets&#125;</span>&quot;</span>)<br>    found_state = <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M // <span class="hljs-number">100</span> + <span class="hljs-number">2</span>):<br>        candidate = k * <span class="hljs-number">100</span> + targets[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> candidate &gt;= M:<br>            <span class="hljs-keyword">break</span><br>        temp_state = candidate<br>        is_valid = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(targets)):<br>            temp_state = (A * temp_state + C) % M<br>            <span class="hljs-keyword">if</span> temp_state % <span class="hljs-number">100</span> != targets[i]:<br>                is_valid = <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">break</span><br>    <br>        <span class="hljs-keyword">if</span> is_valid:<br>            found_state = candidate<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] æ‰¾åˆ°å®Œç¾åŒ¹é…çš„çŠ¶æ€: <span class="hljs-subst">&#123;found_state&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">break</span><br>    <br>    <span class="hljs-keyword">if</span> found_state <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        current_state = found_state<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(targets) - <span class="hljs-number">1</span>):<br>             current_state = (A * current_state + C) % M<br>        <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] é¢„æµ‹æ¥ä¸‹æ¥çš„ 5 ä¸ªæ•°å­—ï¼š&quot;</span>)<br>        predictions = []<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>            current_state = (A * current_state + C) % M<br>            output = current_state % <span class="hljs-number">100</span><br>            predictions.append(<span class="hljs-built_in">str</span>(output))<br>            <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot; &quot;</span>.join(predictions))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] æœªæ‰¾åˆ°è§£ï¼Œå¯èƒ½æ˜¯è¾“å…¥åºåˆ—æœ‰è¯¯ã€‚&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    solve()<br></code></pre></td></tr></table></figure><p>è¿è¡Œæˆªå›¾å¦‚ä¸‹ï¼š</p><img src="/2026/02/27/0xFunCTF2026wp/2.png" class=""><p>æäº¤åå¾—åˆ°flagï¼š</p><img src="/2026/02/27/0xFunCTF2026wp/3.png" class=""><h2 id="MeOwl-ECC">MeOwl ECC</h2><p>æ­£å¸¸çš„æ¤­åœ†æ›²çº¿åŠ å¯†ï¼Œé¢˜ç›®ä½¿ç”¨ç§é’¥$d$ä½œä¸ºåŠ å¯†å¯†é’¥ï¼Œæ±‚è§£æ€è·¯åœ¨äºæ±‚å‡º$d$çš„å€¼ã€‚å°è¯•å¯¹æ›²çº¿çš„é˜¶è¿›è¡Œåˆ†è§£ï¼Œå‘ç°æ— æ³•åˆ†è§£ï¼Œä½†æ˜¯å¯ä»¥å¾—åˆ°æ›²çº¿çš„é˜¶ç­‰äºæ¨¡æ•°$p$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>Smartâ€™s Attack</strong> è¿›è¡Œæ±‚è§£ã€‚</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">1070960903638793793346073212977144745230649115077006408609822474051879875814028659881855169</span><br>A = <span class="hljs-number">0</span><br>B = <span class="hljs-number">19</span><br>E = EllipticCurve(GF(p),[A,B])<br><br>Px = <span class="hljs-number">850194424131363838588909772639181716366575918001556629491986206564277588835368712774900915</span><br>Py = <span class="hljs-number">749509706400667976882772182663506383952119723848300900481860146956631278026417920626334886</span><br><br>Qx = <span class="hljs-number">54250358642669756154015134950152636682437522715786363311759940981383592083045988845753867</span><br>Qy = <span class="hljs-number">324772290891069325219931358863917293864610371020855881775477694333357303867104131696431188</span><br><br>P = E(Px, Py)<br>Q = E(Qx, Qy)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">SmartAttack</span>(<span class="hljs-params">P,Q,p</span>):<br>    E = P.curve()<br>    Eqp = EllipticCurve(Qp(p, <span class="hljs-number">2</span>), [ ZZ(t) + randint(<span class="hljs-number">0</span>,p)*p <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> E.a_invariants() ])<br><br>    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="hljs-number">0</span>]), <span class="hljs-built_in">all</span>=<span class="hljs-literal">True</span>)<br>    <span class="hljs-keyword">for</span> P_Qp <span class="hljs-keyword">in</span> P_Qps:<br>        <span class="hljs-keyword">if</span> GF(p)(P_Qp.xy()[<span class="hljs-number">1</span>]) == P.xy()[<span class="hljs-number">1</span>]:<br>            <span class="hljs-keyword">break</span><br><br>    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="hljs-number">0</span>]), <span class="hljs-built_in">all</span>=<span class="hljs-literal">True</span>)<br>    <span class="hljs-keyword">for</span> Q_Qp <span class="hljs-keyword">in</span> Q_Qps:<br>        <span class="hljs-keyword">if</span> GF(p)(Q_Qp.xy()[<span class="hljs-number">1</span>]) == Q.xy()[<span class="hljs-number">1</span>]:<br>            <span class="hljs-keyword">break</span><br><br>    p_times_P = p*P_Qp<br>    p_times_Q = p*Q_Qp<br><br>    x_P,y_P = p_times_P.xy()<br>    x_Q,y_Q = p_times_Q.xy()<br><br>    phi_P = -(x_P/y_P)<br>    phi_Q = -(x_Q/y_Q)<br>    k = phi_Q/phi_P<br>    <span class="hljs-keyword">return</span> ZZ(k)<br><br>d = SmartAttack(P, Q, p)<br><span class="hljs-built_in">print</span>(d)<br><br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES, DES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>d_found = d  <span class="hljs-comment"># &lt;--- åœ¨è¿™é‡Œå¡«å…¥ä¸Šé¢ç®—å‡ºçš„ d</span><br><br><span class="hljs-comment"># é¢˜ç›®å¯†æ–‡å‚æ•°</span><br>aes_iv_hex = <span class="hljs-string">&quot;7d0e47bb8d111b626f0e17be5a761a14&quot;</span><br>des_iv_hex = <span class="hljs-string">&quot;86fd0c44751700d4&quot;</span><br>ciphertext_hex = (<br>    <span class="hljs-string">&quot;7d34910bca6f505e638ed22f412dbf1b50d03243b739de0090d07fb097ec0a2c&quot;</span><br>    <span class="hljs-string">&quot;a19158949f32e39cd84adea33d2229556f635237088316d2&quot;</span><br>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>():<br>    <span class="hljs-keyword">if</span> d_found == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] è¯·å…ˆè¿è¡Œ SageMath è„šæœ¬ç®—å‡º dï¼Œå¹¶å¡«å…¥ d_found å˜é‡&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-comment"># 1. è¿˜åŸå¯†é’¥</span><br>    k = long_to_bytes(d_found)<br>    aes_key = hashlib.sha256(k + <span class="hljs-string">b&quot;MeOwl::AES&quot;</span>).digest()[:<span class="hljs-number">16</span>]<br>    des_key = hashlib.sha256(k + <span class="hljs-string">b&quot;MeOwl::DES&quot;</span>).digest()[:<span class="hljs-number">8</span>]<br><br>    ciphertext = <span class="hljs-built_in">bytes</span>.fromhex(ciphertext_hex)<br>    aes_iv = <span class="hljs-built_in">bytes</span>.fromhex(aes_iv_hex)<br>    des_iv = <span class="hljs-built_in">bytes</span>.fromhex(des_iv_hex)<br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 2. è§£å¯†å¤–å±‚ (DES)</span><br>        <span class="hljs-comment"># DES ä½¿ç”¨ pad(c1, 8)ï¼Œè§£å¯†åéœ€ unpad 8</span><br>        des_cipher = DES.new(des_key, DES.MODE_CBC, iv=des_iv)<br>        c1_padded = des_cipher.decrypt(ciphertext)<br>        c1 = unpad(c1_padded, <span class="hljs-number">8</span>)<br><br>        <span class="hljs-comment"># 3. è§£å¯†å†…å±‚ (AES)</span><br>        <span class="hljs-comment"># AES ä½¿ç”¨ pad(flag, 16)ï¼Œè§£å¯†åéœ€ unpad 16</span><br>        aes_cipher = AES.new(aes_key, AES.MODE_CBC, iv=aes_iv)<br>        flag_padded = aes_cipher.decrypt(c1)<br>        flag = unpad(flag_padded, <span class="hljs-number">16</span>)<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Flag: <span class="hljs-subst">&#123;flag.decode()&#125;</span>&quot;</span>)<br>        <br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] Decryption failed: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    decrypt()<br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ° flagï¼š<em><strong>0xfun{n0n_c4n0n1c4l_l1f7s_r_c00l}</strong></em></p><h2 id="BitStorm">BitStorm</h2><p>çœ‹ä¼¼ååˆ†å¤æ‚çš„åŠ å¯†è¿‡ç¨‹ï¼Œä»”ç»†æŸ¥çœ‹åå‘ç°éƒ½æ˜¯åœ¨äºŒè¿›åˆ¶åŸŸ <strong>GF(2)</strong> ä¸Šæ˜¯çº¿æ€§çš„ï¼Œæ‰€ä»¥åªè¦è¾“å‡ºå¤Ÿå¤šå°±å¯ä»¥å»ºç«‹çº¿æ€§æ–¹ç¨‹ç»„æ±‚è§£ã€‚</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># ==========================================</span><br><span class="hljs-comment"># 1. ç¬¦å·åŒ–æ•´æ•°ç±» </span><br><span class="hljs-comment"># ==========================================</span><br><br>DIM = <span class="hljs-number">2048</span><br>F = GF(<span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SymInt</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    æ¨¡æ‹Ÿ 64 ä½æ•´æ•°ï¼Œä½¿ç”¨ GF(2) å‘é‡åŠ æ³•ä»£æ›¿ XOR</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, bits=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-keyword">if</span> bits <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-comment"># é»˜è®¤ä¸º 0 (å…¨é›¶å‘é‡)</span><br>            <span class="hljs-variable language_">self</span>.bits = [vector(F, DIM) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-variable language_">self</span>.bits = bits<br>            <span class="hljs-comment"># æˆªæ–­æˆ–å¡«å……è‡³ 64 ä½</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.bits) &gt; <span class="hljs-number">64</span>:<br>                <span class="hljs-variable language_">self</span>.bits = <span class="hljs-variable language_">self</span>.bits[:<span class="hljs-number">64</span>]<br>            <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.bits) &lt; <span class="hljs-number">64</span>:<br>                <span class="hljs-variable language_">self</span>.bits += [vector(F, DIM) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span> - <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.bits))]<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__add__</span>(<span class="hljs-params">self, other</span>):<br>        <span class="hljs-comment"># å¯¹åº”ä½å‘é‡ç›¸åŠ  (GF2 åŠ æ³•å³å¼‚æˆ–)</span><br>        new_bits = [a + b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(<span class="hljs-variable language_">self</span>.bits, other.bits)]<br>        <span class="hljs-keyword">return</span> SymInt(new_bits)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__lshift__</span>(<span class="hljs-params">self, n</span>):<br>        <span class="hljs-comment"># å·¦ç§» n: ä½ä½è¡¥é›¶å‘é‡ï¼Œé«˜ä½ä¸¢å¼ƒ</span><br>        <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span><br>        <span class="hljs-keyword">if</span> n &gt;= <span class="hljs-number">64</span>: <span class="hljs-keyword">return</span> SymInt()<br>        zero_vec = vector(F, DIM)<br>        new_bits = [zero_vec] * n + <span class="hljs-variable language_">self</span>.bits[:-n]<br>        <span class="hljs-keyword">return</span> SymInt(new_bits)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__rshift__</span>(<span class="hljs-params">self, n</span>):<br>        <span class="hljs-comment"># å³ç§» n: é«˜ä½è¡¥é›¶å‘é‡ï¼Œä½ä½ä¸¢å¼ƒ</span><br>        <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span><br>        <span class="hljs-keyword">if</span> n &gt;= <span class="hljs-number">64</span>: <span class="hljs-keyword">return</span> SymInt()<br>        zero_vec = vector(F, DIM)<br>        new_bits = <span class="hljs-variable language_">self</span>.bits[n:] + [zero_vec] * n<br>        <span class="hljs-keyword">return</span> SymInt(new_bits)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">rotate_left</span>(<span class="hljs-params">self, n</span>):<br>        <span class="hljs-comment"># å¾ªç¯å·¦ç§»: (x &lt;&lt; n) | (x &gt;&gt; (64-n))</span><br>        n = n % <span class="hljs-number">64</span><br>        <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span><br>        new_bits = [<span class="hljs-variable language_">self</span>.bits[(i - n) % <span class="hljs-number">64</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>        <span class="hljs-keyword">return</span> SymInt(new_bits)<br><br><span class="hljs-comment"># ==========================================</span><br><span class="hljs-comment"># 2. æ¨¡æ‹Ÿ RNG é€»è¾‘ (ä½¿ç”¨ + ä»£æ›¿ ^)</span><br><span class="hljs-comment"># ==========================================</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SymbolicGiantLinearRNG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.state_size = <span class="hljs-number">32</span><br>        <span class="hljs-variable language_">self</span>.state = []<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.state_size):<br>            shift = <span class="hljs-number">64</span> * (<span class="hljs-variable language_">self</span>.state_size - <span class="hljs-number">1</span> - i)<br>            bits = []<br>            <span class="hljs-keyword">for</span> bit_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>                <span class="hljs-comment"># bit_idx 0 is LSB of this chunk</span><br>                <span class="hljs-comment"># å¯¹åº” seed çš„ç»å¯¹ä½ä½ç½®</span><br>                seed_bit_index = shift + bit_idx<br>                <br>                <span class="hljs-comment"># åˆ›å»ºåŸºå‘é‡</span><br>                v = vector(F, DIM)<br>                <span class="hljs-keyword">if</span> seed_bit_index &lt; DIM:<br>                    v[seed_bit_index] = <span class="hljs-number">1</span><br>                bits.append(v)<br>            <span class="hljs-variable language_">self</span>.state.append(SymInt(bits))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        s = <span class="hljs-variable language_">self</span>.state<br>        taps = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">22</span>, <span class="hljs-number">28</span>, <span class="hljs-number">31</span>]<br>        <br>        new_val = SymInt() <span class="hljs-comment"># 0</span><br>        <br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> taps:<br>            val = s[i]<br>            mixed = val + (val &lt;&lt; <span class="hljs-number">11</span>) + (val &gt;&gt; <span class="hljs-number">7</span>)<br>            <br>            rot = (i * <span class="hljs-number">3</span>) % <span class="hljs-number">64</span><br>            mixed = mixed.rotate_left(rot)<br>            <br>            new_val = new_val + mixed<br> <br>        <span class="hljs-comment"># new_val ^= (s[-1] &gt;&gt; 13) ^ ((s[-1] &lt;&lt; 5) &amp; mask)</span><br>        new_val = new_val + (s[-<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">13</span>) + (s[-<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">5</span>)<br>        <br>        <span class="hljs-comment"># æ›´æ–°çŠ¶æ€</span><br>        <span class="hljs-variable language_">self</span>.state = s[<span class="hljs-number">1</span>:] + [new_val]<br>        <br>        <span class="hljs-comment"># è®¡ç®—è¾“å‡º</span><br>        out = SymInt()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.state_size):<br>            <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>                out = out + <span class="hljs-variable language_">self</span>.state[i]<br>            <span class="hljs-keyword">else</span>:<br>                val = <span class="hljs-variable language_">self</span>.state[i]<br>                <span class="hljs-comment"># out ^= ((val &gt;&gt; 2) | (val &lt;&lt; 62)) -&gt; Rotate Left 62</span><br>                out = out + val.rotate_left(<span class="hljs-number">62</span>)<br>                <br>        <span class="hljs-keyword">return</span> out<br><br><span class="hljs-comment"># ==========================================</span><br><span class="hljs-comment"># 3. ä¸»æ±‚è§£å‡½æ•°</span><br><span class="hljs-comment"># ==========================================</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    real_outputs = [<br>        <span class="hljs-number">11329270341625800450</span>, <span class="hljs-number">14683377949987450496</span>, <span class="hljs-number">11656037499566818711</span>, <span class="hljs-number">14613944493490807838</span>, <br>        <span class="hljs-number">370532313626579329</span>, <span class="hljs-number">5006729399082841610</span>, <span class="hljs-number">8072429272270319226</span>, <span class="hljs-number">3035866339305997883</span>, <br>        <span class="hljs-number">8753420467487863273</span>, <span class="hljs-number">15606411394407853524</span>, <span class="hljs-number">5092825474622599933</span>, <span class="hljs-number">6483262783952989294</span>, <br>        <span class="hljs-number">15380511644426948242</span>, <span class="hljs-number">13769333495965053018</span>, <span class="hljs-number">5620127072433438895</span>, <span class="hljs-number">6809804883045878003</span>, <br>        <span class="hljs-number">1965081297255415258</span>, <span class="hljs-number">2519823891124920624</span>, <span class="hljs-number">8990634037671460127</span>, <span class="hljs-number">3616252826436676639</span>, <br>        <span class="hljs-number">1455424466699459058</span>, <span class="hljs-number">2836976688807481485</span>, <span class="hljs-number">11291016575083277338</span>, <span class="hljs-number">1603466311071935653</span>, <br>        <span class="hljs-number">14629944881049387748</span>, <span class="hljs-number">3844587940332157570</span>, <span class="hljs-number">584252637567556589</span>, <span class="hljs-number">10739738025866331065</span>, <br>        <span class="hljs-number">11650614949586184265</span>, <span class="hljs-number">1828791347803497022</span>, <span class="hljs-number">9101164617572571488</span>, <span class="hljs-number">16034652114565169975</span>, <br>        <span class="hljs-number">13629596693592688618</span>, <span class="hljs-number">17837636002790364294</span>, <span class="hljs-number">10619900844581377650</span>, <span class="hljs-number">15079130325914713229</span>, <br>        <span class="hljs-number">5515526762186744782</span>, <span class="hljs-number">1211604266555550739</span>, <span class="hljs-number">11543408140362566331</span>, <span class="hljs-number">18425294270126030355</span>, <br>        <span class="hljs-number">2629175584127737886</span>, <span class="hljs-number">6074824578506719227</span>, <span class="hljs-number">6900475985494339491</span>, <span class="hljs-number">3263181255912585281</span>, <br>        <span class="hljs-number">12421969688110544830</span>, <span class="hljs-number">10785482337735433711</span>, <span class="hljs-number">10286647144557317983</span>, <span class="hljs-number">15284226677373655118</span>, <br>        <span class="hljs-number">9365502412429803694</span>, <span class="hljs-number">4248763523766770934</span>, <span class="hljs-number">13642948918986007294</span>, <span class="hljs-number">3512868807899248227</span>, <br>        <span class="hljs-number">14810275182048896102</span>, <span class="hljs-number">1674341743043240380</span>, <span class="hljs-number">28462467602860499</span>, <span class="hljs-number">1060872896572731679</span>, <br>        <span class="hljs-number">13208674648176077254</span>, <span class="hljs-number">14702937631401007104</span>, <span class="hljs-number">5386638277617718038</span>, <span class="hljs-number">8935128661284199759</span><br>    ]<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Initializing Symbolic RNG...&quot;</span>)<br>    rng = SymbolicGiantLinearRNG()<br>    <br>    matrix_rows = []<br>    target_vector = []<br>    <br>    <span class="hljs-comment"># å– 40 ä¸ªè¾“å‡º (40 * 64 &gt; 2048) ç¡®ä¿æ»¡ç§©</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Collecting equations...&quot;</span>)<br>    <span class="hljs-keyword">for</span> k, real_val <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(real_outputs[:<span class="hljs-number">40</span>]):<br>        sym_val = rng.<span class="hljs-built_in">next</span>()<br>        <br>        <span class="hljs-keyword">for</span> bit_i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>            <span class="hljs-comment"># è·å–ç¬¦å·åŒ–ç³»æ•° (å‘é‡)</span><br>            coeffs = sym_val.bits[bit_i]<br>            <br>            <span class="hljs-comment"># è·å–çœŸå®å€¼æ¯”ç‰¹</span><br>            target_bit = (real_val &gt;&gt; bit_i) &amp; <span class="hljs-number">1</span><br>            <br>            matrix_rows.append(coeffs)<br>            target_vector.append(target_bit)<br>            <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] Constructing Matrix (<span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(matrix_rows)&#125;</span> x <span class="hljs-subst">&#123;DIM&#125;</span>)...&quot;</span>)<br>    <br>    M = Matrix(F, matrix_rows)<br>    b = vector(F, target_vector)<br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Solving linear system...&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        solution = M.solve_right(b)<br>    <span class="hljs-keyword">except</span> ValueError <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] Solver failed.&quot;</span>)<br>        <span class="hljs-built_in">print</span>(e)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Reconstructing Flag...&quot;</span>)<br>    <br>    seed_int = <span class="hljs-number">0</span><br>    <span class="hljs-comment"># solution å‘é‡çš„ç´¢å¼• i ç›´æ¥å¯¹åº” seed_int çš„ç¬¬ i ä½</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(DIM):<br>        <span class="hljs-keyword">if</span> solution[i] == <span class="hljs-number">1</span>:<br>            seed_int |= (<span class="hljs-number">1</span> &lt;&lt; i)<br>            <br>    <span class="hljs-keyword">try</span>:<br>        flag_bytes = <span class="hljs-built_in">int</span>(seed_int).to_bytes(<span class="hljs-number">256</span>, <span class="hljs-string">&#x27;big&#x27;</span>)<br>        flag = flag_bytes.replace(<span class="hljs-string">b&#x27;\x00&#x27;</span>, <span class="hljs-string">b&#x27;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">60</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;FLAG:&quot;</span>, <span class="hljs-string">&quot;0xfun&#123;&quot;</span> + flag.decode(errors=<span class="hljs-string">&#x27;ignore&#x27;</span>) + <span class="hljs-string">&quot;&#125;&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span>*<span class="hljs-number">60</span> + <span class="hljs-string">&quot;\n&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[-] Decoding error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    solve()<br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°ç»“æœï¼š</p><img src="/2026/02/27/0xFunCTF2026wp/4.png" class=""><h2 id="The-Roulette-Conspiracy">The Roulette Conspiracy</h2><p>å¾ˆæ­£å¸¸çš„ MT19937 éšæœºæ•°ç”Ÿæˆçš„é—®é¢˜ï¼Œé“¾æ¥å®¹å™¨åå‘ç°æ²¡æœ‰é™åˆ¶ spin çš„æ¬¡æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è·å–è¿ç»­çš„624ä¸ªè¾“å‡ºä»è€Œæ¢å¤éšæœºæ•°ç”Ÿæˆå™¨çš„åˆå§‹çŠ¶æ€ï¼Œè¿›è€Œé¢„æµ‹æ¥ä¸‹æ¥çš„10ä¸ªè¾“å‡ºã€‚</p><p>å”¯ä¸€å€¼å¾—æ³¨æ„çš„å°±æ˜¯è„šæœ¬çš„æ•°æ®ä¸Šä¼ æ ¼å¼ï¼ˆï¼‰ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># --- 1. MT19937 é€†å‘æ ¸å¿ƒå‡½æ•° ---</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right_shift</span>(<span class="hljs-params">val, shift</span>):<br>    res = val<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span> // shift):<br>        res = val ^ (res &gt;&gt; shift)<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left_shift</span>(<span class="hljs-params">val, shift, mask</span>):<br>    res = val<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span> // shift):<br>        res = val ^ ((res &lt;&lt; shift) &amp; mask)<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">untemper</span>(<span class="hljs-params">v</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;æ’¤é”€ MT19937 çš„ Tempering è¿‡ç¨‹ï¼Œè¿˜åŸå†…éƒ¨çŠ¶æ€æ•°ç»„çš„å€¼&quot;&quot;&quot;</span><br>    v = inverse_right_shift(v, <span class="hljs-number">18</span>)<br>    v = inverse_left_shift(v, <span class="hljs-number">15</span>, <span class="hljs-number">0xefc60000</span>)<br>    v = inverse_left_shift(v, <span class="hljs-number">7</span>, <span class="hljs-number">0x9d2c5680</span>)<br>    v = inverse_right_shift(v, <span class="hljs-number">11</span>)<br>    <span class="hljs-keyword">return</span> v<br><br><span class="hljs-comment"># --- 2. ç½‘ç»œäº¤äº’é…ç½® ---</span><br>HOST = <span class="hljs-string">&#x27;chall.0xfun.org&#x27;</span> <br>PORT = <span class="hljs-number">43843</span><br><br>io = remote(HOST, PORT)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_next_raw</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;å‘é€ spin æŒ‡ä»¤å¹¶è·å–è¿˜åŸ XOR åçš„åŸå§‹éšæœºæ•°&quot;&quot;&quot;</span><br>    <span class="hljs-comment"># åŒ¹é…æç¤ºç¬¦ &quot;&gt; &quot; (æ³¨æ„å¯èƒ½æœ‰ç©ºæ ¼)</span><br>    io.sendlineafter(<span class="hljs-string">b&quot;&gt;&quot;</span>, <span class="hljs-string">b&quot;spin&quot;</span>)<br>    <span class="hljs-comment"># æ¥æ”¶è¿”å›çš„ä¸€è¡Œæ•°å­—</span><br>    line = io.recvline().decode().strip()<br>    <span class="hljs-comment"># å…¼å®¹æ€§å¤„ç†ï¼šå¦‚æœè¯»åˆ°çš„æ˜¯ç©ºè¡Œï¼Œå†è¯»ä¸€è¡Œ</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> line <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> line.isdigit():<br>        line = io.recvline().decode().strip()<br>    <br>    obfuscated = <span class="hljs-built_in">int</span>(line)<br>    <span class="hljs-comment"># é¢˜ç›®é€»è¾‘ï¼šobfuscated = raw ^ 0xCAFEBABE</span><br>    raw = obfuscated ^ <span class="hljs-number">0xCAFEBABE</span><br>    <span class="hljs-keyword">return</span> raw<br><br><span class="hljs-comment"># --- 3. æ”¶é›† 624 ä¸ªçŠ¶æ€ä»¥å…‹éš†ç”Ÿæˆå™¨ ---</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] æ­£åœ¨ä»æœåŠ¡å™¨æ”¶é›† 624 ä¸ªæ•°æ®ç‚¹...&quot;</span>)<br>state_elements = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    raw_val = get_next_raw()<br>    state_elements.append(untemper(raw_val))<br>    <span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span>) % <span class="hljs-number">100</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å·²æ”¶é›†: <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span>/624&quot;</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] çŠ¶æ€è¿˜åŸæˆåŠŸï¼&quot;</span>)<br><br><span class="hljs-comment"># --- 4. åŒæ­¥æœ¬åœ°ç”Ÿæˆå™¨ ---</span><br><span class="hljs-comment"># è®¾ç½® index ä¸º 624ï¼Œç¡®ä¿ä¸‹ä¸€æ¬¡ getrandbits ä¼šè§¦å‘ twist() ç”Ÿæˆä¸‹ä¸€ç»„åºåˆ—</span><br>predictor = random.Random()<br>predictor.setstate((<span class="hljs-number">3</span>, <span class="hljs-built_in">tuple</span>(state_elements + [<span class="hljs-number">624</span>]), <span class="hljs-literal">None</span>))<br><br><span class="hljs-comment"># --- 5. æäº¤é¢„æµ‹ (ä¸€è¡Œæäº¤) ---</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] æ­£åœ¨å‡†å¤‡é¢„æµ‹ç»“æœ...&quot;</span>)<br>io.sendlineafter(<span class="hljs-string">b&quot;&gt;&quot;</span>, <span class="hljs-string">b&quot;predict&quot;</span>)<br><br><span class="hljs-comment"># ç”Ÿæˆæ¥ä¸‹æ¥ 10 ä¸ªåŸå§‹å€¼ (raw bits)</span><br>predictions = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    val = predictor.getrandbits(<span class="hljs-number">32</span>)<br>    predictions.append(<span class="hljs-built_in">str</span>(val))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é¢„æµ‹å€¼ <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>:2d&#125;</span>: <span class="hljs-subst">&#123;val&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># å°† 10 ä¸ªæ•°å­—ç”¨ç©ºæ ¼è¿æ¥æˆä¸€è¡Œå‘é€</span><br>payload = <span class="hljs-string">&quot; &quot;</span>.join(predictions)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[*] å‘é€ Payload: <span class="hljs-subst">&#123;payload&#125;</span>&quot;</span>)<br>io.sendline(payload.encode())<br><br><span class="hljs-comment"># --- 6. è·å– Flag ---</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[!] ç­‰å¾…æœåŠ¡å™¨å“åº” Flag...&quot;</span>)<br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-comment"># ä½¿ç”¨ interactive() æ–¹ä¾¿åœ¨æ‹¿åˆ° Flag åæ‰‹åŠ¨æ“ä½œï¼Œæˆ–ç›´æ¥ recvall</span><br>    <span class="hljs-comment"># io.interactive() </span><br>    <span class="hljs-built_in">print</span>(io.recvall(timeout=<span class="hljs-number">5</span>).decode())<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[!] è¯»å–ç»“æŸæˆ–è¿æ¥å·²å…³é—­ã€‚&quot;</span>)<br><br>io.close()<br></code></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p><img src="/2026/02/27/0xFunCTF2026wp/5.png" class=""><h2 id="Hawk-II">Hawk_II</h2><p>æ‰“å¼€ä¸€çœ‹å¿«å“æ­»æˆ‘äº†ï¼Œä»£ç é‡æ˜¯çœŸçš„å¤§ã€‚ä½†ä»”ç»†è§‚å¯Ÿåæˆ‘ä»¬å‘ç°ï¼Œé¢˜ç›®å¥½åƒç›´æ¥åœ¨è¾“å‡ºä¸­æ‰“å°äº†ç§é’¥ã€‚è¿™ä¸‹çˆ½äº†ï¼Œç›´æ¥ä¸€ä¸ªç®€å•è„šæœ¬å¸¦èµ°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><br><span class="hljs-comment"># ==========================================</span><br><span class="hljs-comment"># 1. å¡«å…¥é¢˜ç›®è¾“å‡ºçš„ IV å’Œ ENC</span><br><span class="hljs-comment"># ==========================================</span><br>iv_hex = <span class="hljs-string">&quot;ac518ee77848d87912548668d3240aa4&quot;</span>  <br>enc_hex = <span class="hljs-string">&quot;ab425b6c2c0a6760a5e9c52ba25dfc47da97afeeceb9823e553dcccc971b0f25c876ea63ed867d77e3295082064a3f69&quot;</span> <br><br><span class="hljs-comment"># ==========================================</span><br><span class="hljs-comment"># 2. å¡«å…¥é¢˜ç›®è¾“å‡ºçš„ sk å­—ç¬¦ä¸²</span><br><span class="hljs-comment"># ==========================================</span><br><br>sk_str = <span class="hljs-string">&quot;&quot;&quot;(z^255 + z^254 + 4*z^253 - z^252 - z^251 + 2*z^250 + 3*z^249 + 3*z^246 + z^244 + z^243 - 3*z^242 - 2*z^240 - z^238 - z^237 + 2*z^236 + 2*z^235 - z^234 + 2*z^233 + 3*z^232 - 2*z^231 - z^230 + 2*z^229 - z^228 - 3*z^227 + z^226 - z^224 + 3*z^223 + z^222 + z^221 - 2*z^220 + z^219 - 3*z^218 + 2*z^217 - z^216 + 3*z^215 + 6*z^214 + z^213 - 2*z^212 - 2*z^211 - 3*z^210 - 2*z^209 - z^208 - 3*z^207 - z^206 + z^205 + z^204 + 3*z^203 - z^202 + 3*z^201 + z^200 - 2*z^199 - 5*z^198 - 2*z^197 - 2*z^196 - 2*z^195 + 3*z^194 + 6*z^193 - 2*z^192 + z^191 - 2*z^190 - z^189 + z^187 + 2*z^186 - 3*z^185 - 5*z^184 + 5*z^182 - z^181 + 2*z^180 - 4*z^179 + 3*z^178 - z^177 + z^175 - 4*z^173 - 2*z^171 + z^169 + 2*z^168 + z^167 - z^166 + 4*z^165 - 3*z^164 - 3*z^163 - 3*z^162 + z^161 - 3*z^160 - 3*z^159 + 2*z^158 - 2*z^156 - 2*z^155 + 3*z^154 - z^153 - 2*z^152 - z^151 - 2*z^150 - z^149 + z^148 + z^147 - 4*z^146 - 2*z^145 + 3*z^144 + 4*z^143 - z^142 - 2*z^141 + 2*z^139 - 2*z^138 - 3*z^136 + z^135 + z^134 + 3*z^133 - z^132 + z^131 - 4*z^130 - 2*z^129 - z^128 + z^127 - z^126 - 3*z^125 + z^124 + 2*z^123 + 3*z^122 - 4*z^120 + 6*z^119 - 3*z^118 + z^117 + z^116 + 4*z^115 + 2*z^114 - z^113 + 2*z^112 - z^111 - z^110 - 4*z^109 - 3*z^107 + z^106 + 3*z^105 + 2*z^103 - z^102 + z^101 - z^100 + z^98 + z^95 - 3*z^94 + z^93 - 2*z^92 + z^91 - 5*z^90 + 3*z^89 - z^88 - z^87 - 4*z^86 + z^85 - z^84 + 2*z^82 - 2*z^81 + z^78 + z^75 + 5*z^74 + z^73 + z^71 - 3*z^70 - z^68 + 2*z^67 - z^66 + z^65 - 2*z^64 + 2*z^63 + z^62 - 3*z^61 - 2*z^60 - 3*z^58 + 2*z^57 + z^56 - 2*z^55 + z^54 + z^53 + 4*z^52 - z^51 + z^50 - z^49 + z^48 + z^47 - z^46 + 2*z^45 - z^43 - z^42 + z^41 - z^40 - 7*z^39 + 3*z^38 + 3*z^37 + z^36 - z^35 + 2*z^34 + 2*z^31 + 2*z^29 - 3*z^28 - z^26 + z^25 - z^24 + 2*z^23 - 3*z^22 - z^21 + z^20 - 2*z^18 + z^17 + z^15 - z^14 + 2*z^12 - 2*z^11 - z^10 + 2*z^9 + z^8 - z^7 + z^6 - 3*z^5 - z^4 + 3*z^3 - 5*z^2 - z, 2*z^255 - z^254 + z^253 + z^252 - 4*z^250 + 2*z^249 - z^248 + z^246 + z^244 + 2*z^242 - z^241 + 2*z^239 + 2*z^238 - 2*z^237 - 3*z^236 + z^235 - 2*z^234 + z^233 + 3*z^231 + z^230 + z^229 + 3*z^228 - 2*z^227 - z^226 - z^224 - z^223 + 4*z^222 - 3*z^220 - z^219 + 2*z^218 - z^217 - 2*z^216 + 3*z^215 + 2*z^214 - 2*z^213 + z^210 + z^209 + 5*z^207 + z^206 - z^205 - z^202 - 2*z^200 - 2*z^199 + z^198 + z^197 - z^196 + 3*z^195 + 4*z^194 - 2*z^193 + 3*z^191 - z^189 + 5*z^188 - 5*z^187 + z^185 + 3*z^184 - 4*z^183 + 3*z^182 - z^181 - z^180 + 4*z^179 + 3*z^178 - 3*z^176 + z^175 - z^174 + z^173 - 3*z^171 + z^169 - z^168 - 3*z^167 - z^165 + z^164 + 2*z^162 - z^161 - 2*z^160 + z^158 + 2*z^156 + z^155 + 2*z^154 - z^153 + 4*z^152 - 4*z^151 - 3*z^150 + 4*z^149 - 2*z^147 + z^146 - z^145 - z^144 + z^143 + z^142 - 2*z^140 + 2*z^139 + 2*z^138 + 3*z^137 - 2*z^136 + z^135 - 3*z^134 - 3*z^133 - z^132 + z^131 + 2*z^130 - z^129 + 4*z^128 - z^127 - z^126 + z^125 - 3*z^124 - z^123 + z^122 + z^121 - 3*z^120 + z^119 + z^118 + 3*z^117 - 2*z^116 - z^115 + z^114 + 2*z^113 + 4*z^112 + 2*z^111 - 2*z^110 + z^109 - 2*z^108 + z^107 - 2*z^105 + 4*z^103 - z^101 - 2*z^100 + 6*z^98 + 3*z^97 - z^94 - 2*z^92 - z^91 - 3*z^90 + z^89 + z^88 + 2*z^87 + z^86 - z^85 + 2*z^84 + 2*z^83 - z^82 - 3*z^81 + 3*z^80 - 2*z^79 - 2*z^78 + 2*z^77 + 3*z^76 + z^75 + z^70 - z^69 - z^68 + 2*z^67 - 2*z^66 - z^65 - 3*z^64 - z^63 - 2*z^62 + z^61 + 2*z^60 + 3*z^59 + z^58 + z^57 - 5*z^56 + 2*z^55 + 3*z^54 + z^53 + 4*z^52 + z^51 - z^50 - z^49 + z^48 - 3*z^47 - z^46 + 2*z^44 - z^42 - 3*z^41 + 3*z^38 + z^37 - 2*z^35 - 2*z^34 - z^33 + z^32 + 4*z^31 + 2*z^30 - 2*z^29 - 2*z^27 + z^25 - z^24 - 3*z^23 + 2*z^21 + 2*z^17 - z^16 - 3*z^15 + 2*z^14 + z^12 + 2*z^11 + 2*z^10 + 3*z^9 + 4*z^8 - 2*z^6 - z^5 + 3*z^4 + z^2 + z - 2, 13*z^255 - 17*z^254 - 3*z^253 - 8*z^252 + 7*z^251 - 15*z^250 + 21*z^249 + 11*z^248 - 7*z^247 + 22*z^246 + 3*z^245 - 10*z^244 - 8*z^243 - 12*z^242 + 5*z^241 + 8*z^240 + 4*z^239 - 6*z^238 + 16*z^237 - 2*z^236 + 21*z^235 - z^234 - 14*z^233 - z^232 + 11*z^231 - 5*z^230 + 3*z^229 + 12*z^228 + 11*z^227 + 5*z^226 + 2*z^225 + 18*z^224 - 13*z^222 + 14*z^221 + 6*z^220 - 3*z^219 + 13*z^218 + 2*z^217 - 11*z^216 - 3*z^215 + 8*z^214 + z^213 - 3*z^212 - 11*z^211 - 4*z^210 + 2*z^209 - 16*z^208 + 11*z^207 + 5*z^206 - 12*z^205 + 17*z^204 + 15*z^203 - 5*z^201 - 19*z^200 - 8*z^199 - 11*z^198 + 13*z^197 - 18*z^196 + 18*z^195 - 6*z^194 + z^193 + 6*z^192 - 11*z^191 + 2*z^190 + 7*z^189 - 4*z^188 + 2*z^187 - z^186 + 5*z^185 - 13*z^184 - 6*z^183 - 4*z^182 + 19*z^181 - 4*z^180 + 20*z^179 - 11*z^178 + 5*z^177 - 5*z^176 - z^175 + z^174 + 2*z^172 + 4*z^171 + 3*z^170 + 3*z^169 - 7*z^168 - 9*z^167 - 14*z^166 + 13*z^165 + 2*z^164 - 4*z^163 - 3*z^162 + 7*z^161 + 17*z^160 + 8*z^159 + 6*z^158 - 16*z^157 + 11*z^156 + 17*z^155 + 2*z^154 - 4*z^153 - 5*z^152 + 5*z^151 - 4*z^150 - 2*z^149 + 3*z^148 - 3*z^147 - 7*z^146 + 12*z^145 + 5*z^144 + 5*z^143 - 11*z^142 - 5*z^141 - 9*z^140 - 3*z^139 + 11*z^137 - 7*z^136 + 14*z^135 + 5*z^134 + 12*z^133 - z^132 - z^131 - 14*z^130 - 3*z^129 - 8*z^128 + 7*z^127 + 11*z^126 + 12*z^125 - 2*z^124 + 6*z^123 - 6*z^122 - 2*z^121 - 20*z^120 - 6*z^119 + 2*z^118 + 11*z^117 - 4*z^116 - 9*z^115 - 5*z^114 + 3*z^113 + 5*z^112 + 4*z^111 + 6*z^109 - 8*z^108 + 12*z^107 - z^106 + 6*z^105 + z^104 - 11*z^103 - 9*z^102 - 5*z^101 + 4*z^100 + 5*z^99 + z^98 - 6*z^97 - 9*z^96 + 6*z^95 + 3*z^94 + 10*z^93 - 5*z^92 - 12*z^91 + 4*z^90 - 10*z^89 + 9*z^88 + z^87 + 3*z^86 + z^85 + 17*z^84 + 4*z^83 - 25*z^82 - 4*z^81 - 3*z^80 + 23*z^79 - 6*z^78 - 4*z^77 - 5*z^76 + 7*z^75 + 2*z^74 + 7*z^73 + z^71 - 12*z^70 + 6*z^69 + 7*z^68 - 9*z^67 - 16*z^66 + 16*z^65 - 10*z^64 + 11*z^63 - 6*z^62 + 5*z^61 - 8*z^60 - 3*z^58 + z^57 - 5*z^56 + 11*z^54 - 4*z^53 + 4*z^52 + 7*z^51 - 17*z^50 - 11*z^49 + 14*z^48 + 4*z^47 + 8*z^46 - 7*z^45 - 5*z^44 + 5*z^43 + 9*z^42 - 2*z^41 + 6*z^40 - 9*z^39 - 23*z^38 - 7*z^37 - 10*z^36 + 10*z^35 - z^34 + z^33 - z^32 + 12*z^31 + 9*z^30 - 5*z^29 - z^28 - 18*z^27 + 2*z^26 - 2*z^25 - 6*z^24 + 11*z^23 - 5*z^22 + 5*z^21 + 4*z^20 + 3*z^19 - 2*z^18 - 5*z^17 - 8*z^16 + 8*z^15 + 14*z^14 + 5*z^12 - 12*z^11 - 27*z^10 + 20*z^9 + 10*z^8 - 12*z^7 - 3*z^6 + 8*z^5 - 7*z^4 + 12*z^3 + 4*z^2 - 20*z - 10, -z^255 + 5*z^254 - 4*z^253 - 5*z^252 + 4*z^251 + 3*z^249 - 13*z^248 - 16*z^247 - 7*z^246 + 3*z^245 + 2*z^244 + 3*z^243 + 10*z^242 + 7*z^241 - 15*z^240 - 11*z^239 - 7*z^238 - 5*z^237 + 3*z^236 + 10*z^235 + 3*z^234 - 16*z^233 + 3*z^232 - 13*z^230 + 10*z^229 + 9*z^228 + 14*z^227 - 4*z^226 + 9*z^225 - 18*z^224 - 23*z^223 + 4*z^222 - z^221 + 3*z^219 + 17*z^218 - 9*z^217 + 2*z^216 + 10*z^215 - 17*z^214 - 14*z^213 + 15*z^212 + 21*z^211 - 10*z^210 + 22*z^209 - 29*z^207 - 19*z^206 + 6*z^205 + 5*z^204 - 12*z^203 + 15*z^202 + 12*z^201 - 3*z^200 - 6*z^199 + 14*z^198 - 6*z^197 - 4*z^196 + 11*z^195 - 9*z^194 - z^193 - 7*z^191 - 2*z^190 - 2*z^189 - 3*z^187 - 8*z^186 + 2*z^185 + 5*z^184 + 4*z^183 + 3*z^182 - 10*z^180 - 14*z^179 + 6*z^178 - 3*z^177 - 8*z^176 + 12*z^175 + 11*z^174 + z^173 - 2*z^172 - 13*z^171 - 24*z^170 + 2*z^168 - 11*z^167 + 6*z^166 + 7*z^165 + 8*z^164 - 8*z^163 + 5*z^162 - 9*z^161 + 4*z^160 + 7*z^159 + 9*z^158 - 2*z^157 - 7*z^156 + z^155 - 18*z^154 - 3*z^153 - 5*z^152 + 19*z^151 - z^150 - 3*z^149 - 2*z^148 - 13*z^147 + 3*z^146 - z^145 + 4*z^144 - 7*z^143 + 5*z^142 + z^141 - 3*z^140 - z^139 - z^138 - 16*z^137 - 13*z^136 + 10*z^135 + 14*z^134 + z^133 + 18*z^132 - 18*z^131 - 3*z^130 - 4*z^129 + 9*z^128 - 13*z^127 - z^126 + 4*z^125 + 3*z^124 + z^123 - 10*z^122 + 6*z^121 + 8*z^120 + 6*z^119 + 7*z^118 + 11*z^117 - 9*z^116 + 7*z^115 + 14*z^114 - 13*z^113 - 8*z^112 + 12*z^111 + 4*z^110 + 5*z^109 + 10*z^108 - 15*z^107 - 14*z^106 + 10*z^105 + 2*z^104 - z^103 - 13*z^102 + 12*z^101 + 7*z^100 + 4*z^99 - z^97 - 8*z^96 - 7*z^95 + 5*z^94 + 4*z^93 + 3*z^92 - 10*z^91 - 2*z^90 + 4*z^89 + 18*z^88 + 6*z^87 + 7*z^86 + 4*z^84 - 5*z^83 - 3*z^82 + 7*z^81 - 17*z^80 - 10*z^79 + 2*z^78 - 7*z^77 - 6*z^76 + 2*z^75 + z^74 - 15*z^73 + 14*z^72 + 14*z^71 - 6*z^70 + 16*z^69 + 6*z^68 + 2*z^67 - 4*z^66 + 5*z^65 - 10*z^64 + z^63 - 5*z^62 + 4*z^61 + z^60 - 5*z^59 + 5*z^58 + 8*z^57 - 2*z^56 - z^55 + 16*z^54 - 4*z^53 - 9*z^52 - 10*z^50 + 14*z^48 + z^47 - 21*z^46 - 6*z^45 + 15*z^44 + 9*z^43 + 4*z^42 + 11*z^41 + 4*z^40 - 6*z^39 + 2*z^37 - 15*z^36 + 3*z^35 + 13*z^34 + 7*z^33 - 14*z^32 - 9*z^31 - z^30 - 4*z^29 + 8*z^28 + 9*z^27 - z^26 - 6*z^25 + 19*z^24 + 14*z^23 - 15*z^22 + 4*z^21 + 4*z^20 - 5*z^19 + 4*z^18 + 14*z^17 + 8*z^16 + z^15 - 3*z^14 - 12*z^13 + 3*z^12 + 3*z^11 + 12*z^10 + 7*z^9 + 4*z^8 + 11*z^7 - z^6 - 10*z^5 + 7*z^4 - z^3 - 16*z^2 + 3*z + 13)&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># ==========================================</span><br><span class="hljs-comment"># 3. è§£å¯†</span><br><span class="hljs-comment"># ==========================================</span><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-comment"># ç”Ÿæˆè§£å¯†å¯†é’¥</span><br>    key = sha256(sk_str.encode()).digest()<br>    <br>    <span class="hljs-comment"># è½¬æ¢ hex ä¸º bytes</span><br>    iv = <span class="hljs-built_in">bytes</span>.fromhex(iv_hex)<br>    enc = <span class="hljs-built_in">bytes</span>.fromhex(enc_hex)<br>    <br>    <span class="hljs-comment"># AES è§£å¯†</span><br>    cipher = AES.new(key=key, mode=AES.MODE_CBC, iv=iv)<br>    plaintext = cipher.decrypt(enc)<br>    <br>    <span class="hljs-comment"># å»é™¤å¡«å……å¹¶æ‰“å° Flag</span><br>    flag = unpad(plaintext, <span class="hljs-number">16</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[SUCCESS] Flag found:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(flag.decode())<br>    <br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[ERROR] Decryption failed: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p><img src="/2026/02/27/0xFunCTF2026wp/9.png" class=""><h2 id="The-Fortune-Teller">The Fortune Teller</h2><p>Gemini å¾—äº† MVP ï¼Œæˆ‘å°±æ˜¯èººèµ¢ç‹—ï¼ˆï¼‰ã€‚</p><p>ä¸ <strong>The Slot Whisperer</strong> ç±»ä¼¼ï¼Œä½†å› ä¸ºæ•°å­—å¾ˆå¤§ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨çˆ†ç ´äº†ã€‚å› ä¸ºæ³„éœ²äº†é«˜32ä½ï¼ŒåŒæ—¶ç»™å‡ºäº†ä¸‰ä¸ªå·²çŸ¥è¾“å‡ºï¼Œå¾ˆæ˜¾ç„¶æˆ‘ä»¬ä¼šæ€è€ƒå»æ„é€ ä¸€ä¸ªæ ¼å‡ºæ¥ï¼Œç„¶åç”¨<strong>æ ¼åŸºè§„çº¦</strong>æ±‚è§£ã€‚</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># SageMath è„šæœ¬</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    <span class="hljs-comment"># 1. å®šä¹‰å¸¸æ•°</span><br>    M = <span class="hljs-number">2</span>^<span class="hljs-number">64</span><br>    A = <span class="hljs-number">2862933555777941757</span><br>    C = <span class="hljs-number">3037000493</span><br>    <br>    <span class="hljs-comment"># é¢˜ç›®ç»™å‡ºçš„è§‚æµ‹å€¼ (é«˜32ä½)</span><br>    glimpses = [<span class="hljs-number">1332353447</span>, <span class="hljs-number">4117841481</span>, <span class="hljs-number">4217378265</span>]<br>    <br>    <span class="hljs-comment"># 2. å‡†å¤‡æ„å»ºæ ¼æ‰€éœ€çš„å‚æ•°</span><br>    <span class="hljs-comment"># è®¡ç®— K_i (Bias)</span><br>    <span class="hljs-comment"># å…³ç³»æ¨å¯¼: x_i = A^i * x_0 + K_i (mod M)</span><br>    <span class="hljs-comment"># K_i = (A^i * y0_full + Cumulative_C_i - yi_full) % M</span><br>    <br>    K = []<br>    <br>    <span class="hljs-comment"># è®¡ç®— A^i å’Œ ç´¯ç§¯ C</span><br>    <span class="hljs-comment"># S_i = A^i * S_0 + term_c</span><br>    <span class="hljs-comment"># term_c[0] = 0</span><br>    <span class="hljs-comment"># term_c[1] = C</span><br>    <span class="hljs-comment"># term_c[2] = A*C + C</span><br>    <br>    term_c = [<span class="hljs-number">0</span>, C, (A*C + C) % M]<br>    term_a = [<span class="hljs-number">1</span>, A, (A^<span class="hljs-number">2</span>) % M]<br>    <br>    base_shift = <span class="hljs-number">2</span>^<span class="hljs-number">32</span><br>    y0_full = glimpses[<span class="hljs-number">0</span>] * base_shift<br>    <br>    <span class="hljs-comment"># è®¡ç®— K1, K2 (å¯¹åº” glimpse[1], glimpse[2])</span><br>    <span class="hljs-comment"># æ³¨æ„ï¼šå¯¹äº i=0, x0 = 1*x0 + 0, æ‰€ä»¥ K0=0ï¼Œæˆ‘ä»¬åœ¨çŸ©é˜µä¸­ä¸éœ€è¦ K0ï¼Œåªå¤„ç† K1, K2</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>):<br>        yi_full = glimpses[i] * base_shift<br>        <span class="hljs-comment"># K_i = A^i * (y0_full) + term_c[i] - yi_full</span><br>        val = (term_a[i] * y0_full + term_c[i] - yi_full) % M<br>        K.append(val)<br>        <br>    <span class="hljs-comment"># 3. æ„å»ºçŸ©é˜µ</span><br>    <span class="hljs-comment"># ç›®æ ‡å¯»æ‰¾çŸ­å‘é‡: (x0, x1, x2, 1)</span><br>    <span class="hljs-comment"># Matrix B (4x4):</span><br>    <span class="hljs-comment"># [ 1,    A,    A^2,  0 ]</span><br>    <span class="hljs-comment"># [ 0,    M,    0,    0 ]</span><br>    <span class="hljs-comment"># [ 0,    0,    M,    0 ]</span><br>    <span class="hljs-comment"># [ 0,    K1,   K2,   1 ]</span><br>    <br>    B = Matrix(ZZ, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>)<br>    B[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] = <span class="hljs-number">1</span><br>    B[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>] = term_a[<span class="hljs-number">1</span>]<br>    B[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>] = term_a[<span class="hljs-number">2</span>]<br>    B[<span class="hljs-number">0</span>, <span class="hljs-number">3</span>] = <span class="hljs-number">0</span><br>    <br>    B[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] = M<br>    B[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>] = M<br>    <br>    B[<span class="hljs-number">3</span>, <span class="hljs-number">1</span>] = K[<span class="hljs-number">0</span>] <span class="hljs-comment"># K1</span><br>    B[<span class="hljs-number">3</span>, <span class="hljs-number">2</span>] = K[<span class="hljs-number">1</span>] <span class="hljs-comment"># K2</span><br>    B[<span class="hljs-number">3</span>, <span class="hljs-number">3</span>] = <span class="hljs-number">1</span>    <span class="hljs-comment"># Constant constrol</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Executing LLL reduction...&quot;</span>)<br>    L = B.LLL()<br>    <br>    <span class="hljs-comment"># 4. ä»è§„çº¦åçš„åŸºä¸­æå–è§£</span><br>    real_x0 = <span class="hljs-literal">None</span><br>    <br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> L:<br>        <span class="hljs-comment"># LLL å¯èƒ½äº§ç”Ÿæ­£è´Ÿå·ç¿»è½¬çš„å‘é‡ï¼Œæ£€æŸ¥æœ€åä¸€ç»´æ˜¯ 1 æˆ– -1</span><br>        vec = <span class="hljs-built_in">list</span>(row)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>(vec[<span class="hljs-number">3</span>]) == <span class="hljs-number">1</span>:<br>            potential_x0 = vec[<span class="hljs-number">0</span>] * vec[<span class="hljs-number">3</span>] <span class="hljs-comment"># ä¿®æ­£ç¬¦å·</span><br>            <br>            <span class="hljs-comment"># éªŒè¯ x0 èŒƒå›´</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt;= potential_x0 &lt; <span class="hljs-number">2</span>^<span class="hljs-number">32</span>:<br>                <span class="hljs-comment"># è¿›ä¸€æ­¥éªŒè¯æ˜¯å¦ç¬¦åˆ glimpse åºåˆ—</span><br>                s0 = y0_full + potential_x0<br>                <br>                <span class="hljs-comment"># æ¨¡æ‹Ÿæ¨å¯¼</span><br>                curr = s0<br>                valid = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">for</span> g <span class="hljs-keyword">in</span> glimpses:<br>                    <span class="hljs-keyword">if</span> (curr &gt;&gt; <span class="hljs-number">32</span>) != g:<br>                        valid = <span class="hljs-literal">False</span><br>                        <span class="hljs-keyword">break</span><br>                    curr = (curr * A + C) % M<br>                <br>                <span class="hljs-keyword">if</span> valid:<br>                    real_x0 = potential_x0<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n[+] Found x0: <span class="hljs-subst">&#123;real_x0&#125;</span>&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[+] Recovered Initial State S0: <span class="hljs-subst">&#123;s0&#125;</span>&quot;</span>)<br>                    <span class="hljs-keyword">break</span><br>    <br>    <span class="hljs-keyword">if</span> real_x0 <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-comment"># 5. é¢„æµ‹å5ä¸ªçŠ¶æ€</span><br>        <span class="hljs-comment"># å½“å‰æˆ‘ä»¬éªŒè¯å®Œ glimpses åï¼Œcurr å·²ç»æ˜¯ S3 (å³ç¬¬3ä¸ªè¾“å‡ºä¹‹åçš„ä¸‹ä¸€ä¸ªçŠ¶æ€)</span><br>        <span class="hljs-comment"># é¢˜ç›®è¦æ±‚é¢„æµ‹æ¥ä¸‹æ¥ 5 ä¸ª</span><br>        <br>        state = (y0_full + real_x0)<br>        <br>        <span class="hljs-comment"># å…ˆç©ºè½¬å‰3æ¬¡ (å¯¹åº”å·²çŸ¥çš„3ä¸ªè¾“å‡º)</span><br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>            state = (state * A + C) % M<br>            <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n[+] Next 5 full 64-bit states:&quot;</span>)<br>        results = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;State <span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span>: <span class="hljs-subst">&#123;state&#125;</span>&quot;</span>)<br>            results.append(<span class="hljs-built_in">str</span>(state))<br>            state = (state * A + C) % M<br>            <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nFinal Answer String:&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot; &quot;</span>.join(results))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[-] LLL failed.&quot;</span>)<br><br>solve()<br></code></pre></td></tr></table></figure><p>è¿è¡Œåå¾—åˆ°ç»“æœï¼š</p><img src="/2026/02/27/0xFunCTF2026wp/7.png" class=""><p>è¿œç¨‹æäº¤åå³å¯å¾—åˆ° flag ï¼š</p><img src="/2026/02/27/0xFunCTF2026wp/8.png" class=""><p>è¯¦ç»†çš„é¢˜ç›®æ–‡ä»¶ä¸è§£é¢˜è„šæœ¬ä»¥åŠ <strong>WriteUp</strong> çš„ pdf å¯ä»¥é€šè¿‡å…³äºé¡µä¸­æˆ‘çš„ GitHub ä»“åº“æ‰¾åˆ°ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>åšé¢˜å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
